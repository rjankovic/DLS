/*
Deployment script for cpicustdb

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "cpicustdb"
:setvar DefaultFilePrefix "cpicustdb"
:setvar DefaultDataPath ""
:setvar DefaultLogPath ""

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
PRINT N'Dropping [Adm].[FK_Adm_PowerBiProjectComponents_Adm_ProjectConfigs_ProjectConfig_ProjectConfigId]...';


GO
ALTER TABLE [Adm].[PowerBiProjectComponents] DROP CONSTRAINT [FK_Adm_PowerBiProjectComponents_Adm_ProjectConfigs_ProjectConfig_ProjectConfigId];


GO
PRINT N'Dropping [Adm].[sp_SetProjectPowerBiComponents]...';


GO
DROP PROCEDURE [Adm].[sp_SetProjectPowerBiComponents];


GO
PRINT N'Dropping [Adm].[UDTT_PowerBiProjectComponents]...';


GO
DROP TYPE [Adm].[UDTT_PowerBiProjectComponents];


GO
PRINT N'Creating [Adm].[UDTT_PowerBiProjectComponents]...';


GO
CREATE TYPE [Adm].[UDTT_PowerBiProjectComponents] AS TABLE (
    [RedirectUri]        NVARCHAR (200) NULL,
    [ApplicationID]      NVARCHAR (200) NULL,
    [WorkspaceID]        NVARCHAR (200) NULL,
    [ReportServerURL]    NVARCHAR (200) NULL,
    [ReportServerFolder] NVARCHAR (200) NULL);


GO
PRINT N'Starting rebuilding table [Adm].[PowerBiProjectComponents]...';


GO
BEGIN TRANSACTION;

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

SET XACT_ABORT ON;

CREATE TABLE [Adm].[tmp_ms_xx_PowerBiProjectComponents] (
    [PowerBiProjectComponentId]     INT              IDENTITY (1, 1) NOT NULL,
    [RedirectUri]                   NVARCHAR (200)   NULL,
    [ApplicationID]                 NVARCHAR (200)   NULL,
    [WorkspaceID]                   NVARCHAR (200)   NULL,
    [ReportServerURL]               NVARCHAR (200)   NULL,
    [ReportServerFolder]            NVARCHAR (200)   NULL,
    [ProjectConfig_ProjectConfigId] UNIQUEIDENTIFIER NULL,
    CONSTRAINT [tmp_ms_xx_constraint_PK_dbo.PowerBiProjectComponents1] PRIMARY KEY CLUSTERED ([PowerBiProjectComponentId] ASC)
);

IF EXISTS (SELECT TOP 1 1 
           FROM   [Adm].[PowerBiProjectComponents])
    BEGIN
        SET IDENTITY_INSERT [Adm].[tmp_ms_xx_PowerBiProjectComponents] ON;
        INSERT INTO [Adm].[tmp_ms_xx_PowerBiProjectComponents] ([PowerBiProjectComponentId], [RedirectUri], [ApplicationID], [WorkspaceID], [ProjectConfig_ProjectConfigId])
        SELECT   [PowerBiProjectComponentId],
                 [RedirectUri],
                 [ApplicationID],
                 [WorkspaceID],
                 [ProjectConfig_ProjectConfigId]
        FROM     [Adm].[PowerBiProjectComponents]
        ORDER BY [PowerBiProjectComponentId] ASC;
        SET IDENTITY_INSERT [Adm].[tmp_ms_xx_PowerBiProjectComponents] OFF;
    END

DROP TABLE [Adm].[PowerBiProjectComponents];

EXECUTE sp_rename N'[Adm].[tmp_ms_xx_PowerBiProjectComponents]', N'PowerBiProjectComponents';

EXECUTE sp_rename N'[Adm].[tmp_ms_xx_constraint_PK_dbo.PowerBiProjectComponents1]', N'PK_dbo.PowerBiProjectComponents', N'OBJECT';

COMMIT TRANSACTION;

SET TRANSACTION ISOLATION LEVEL READ COMMITTED;


GO
PRINT N'Creating [Adm].[FK_Adm_PowerBiProjectComponents_Adm_ProjectConfigs_ProjectConfig_ProjectConfigId]...';


GO
ALTER TABLE [Adm].[PowerBiProjectComponents] WITH NOCHECK
    ADD CONSTRAINT [FK_Adm_PowerBiProjectComponents_Adm_ProjectConfigs_ProjectConfig_ProjectConfigId] FOREIGN KEY ([ProjectConfig_ProjectConfigId]) REFERENCES [Adm].[ProjectConfigs] ([ProjectConfigId]);


GO
PRINT N'Altering [Adm].[f_GetPowerBiProjectComponents]...';


GO
ALTER FUNCTION [Adm].[f_GetPowerBiProjectComponents]
(
@projectconfigid UNIQUEIDENTIFIER
)
RETURNS TABLE
AS RETURN
(
	SELECT
	[PowerBiProjectComponentId]
    ,[RedirectUri]
	,[ApplicationID]
	,[WorkspaceID]
	,[ReportServerURL]
	,[ReportServerFolder]
	,[ProjectConfig_ProjectConfigId] 
	FROM adm.PowerBiProjectComponents WHERE ProjectConfig_ProjectConfigId = @projectconfigid
)
GO
PRINT N'Altering [Inspect].[f_ListExternalDfSourceColumns]...';


GO
ALTER FUNCTION [Inspect].[f_ListExternalDfSourceColumns]
(
	@projectconfigid UNIQUEIDENTIFIER
)
RETURNS TABLE AS
RETURN
(

WITH externalDfSources AS(
SELECT 
se.ModelElementId, 
/**/ISNULL(JSON_VALUE(se.ExtendedProperties, '$.Command'), JSON_VALUE(se.ExtendedProperties, '$.OpenRowset')) /**/ /*N''*/ Command,
se.RefPath,
se.Caption,
mngre.Caption ManagerCaption,
/**/JSON_VALUE(mngre.ExtendedProperties, N'$.SourceType')/**/ /*adm.f_SimpleJsonValue(mngre.ExtendedProperties, N'SourceType')*/ SourceType,
/**/JSON_VALUE(mngre.ExtendedProperties, N'$.ConnectionString')/**/ /*adm.f_SimpleJsonValue(mngre.ExtendedProperties, N'ConnectionString')*/ ConnectionString,
/**/JSON_VALUE(mngre.ExtendedProperties, N'$.LocaleID')/**/ /*adm.f_SimpleJsonValue(mngre.ExtendedProperties, N'LocaleID')*/ LocaleID,
/**/JSON_VALUE(mngre.ExtendedProperties, N'$.CodePage')/**/ /*adm.f_SimpleJsonValue(mngre.ExtendedProperties, N'CodePage')*/ CodePage,
/**/JSON_VALUE(mngre.ExtendedProperties, N'$.Format')/**/ /*adm.f_SimpleJsonValue(mngre.ExtendedProperties, N'Format')*/ FileFormat
,pkge.ModelElementId PackageElementId
,pkge.RefPath PackageRefPath
,pkge.Caption PackageCaption
FROM BIDoc.ModelElements se
INNER JOIN BIDoc.ModelLinks mngrl ON se.ModelElementId = mngrl.ElementFromId AND mngrl.Type = N'SourceConnection'
INNER JOIN BIDoc.ModelElements mngre ON mngre.ModelElementId = mngrl.ElementToId
INNER JOIN BIDoc.ModelElements pkge ON LEFT(se.RefPath, LEN(pkge.RefPath)) = pkge.RefPath
WHERE se.Type = N'CD.DLS.Model.Mssql.Ssis.DfSourceElement' 
--AND adm.f_SimpleJsonValue(se.ExtendedProperties, N'IsExternalSource') = N'true' 
AND JSON_VALUE(se.ExtendedProperties, '$.IsExternalSource') = N'true' 
AND se.ProjectConfigId = @projectconfigid
AND pkge.Type = N'CD.DLS.Model.Mssql.Ssis.PackageElement' AND pkge.ProjectConfigId = @projectconfigid
)
SELECT se.ModelElementId SourceElementId, ce.ModelElementId, ce.Caption ColumnName
,/**/JSON_VALUE(ce.ExtendedProperties, '$.DtsDataType') /**/ /*adm.f_SimpleJsonValue(ce.ExtendedProperties, N'DtsDataType')*/ DataType
,/**/JSON_VALUE(ce.ExtendedProperties, '$.Length') /**/ /*adm.f_SimpleJsonValue(ce.ExtendedProperties, N'Length')*/ Length
,/**/JSON_VALUE(ce.ExtendedProperties, '$.Precision') /**/ /*adm.f_SimpleJsonValue(ce.ExtendedProperties, N'Precision')*/ Precision
,/**/JSON_VALUE(ce.ExtendedProperties, '$.Scale') /**/ /*adm.f_SimpleJsonValue(ce.ExtendedProperties, N'Scale')*/ Scale
,ce.RefPath

FROM externalDfSources se
INNER JOIN BIDoc.BasicGraphNodes n ON n.SourceElementId = se.ModelElementId AND n.GraphKind = N'DataFlow'
INNER JOIN BIDoc.BasicGraphNodes c1 ON c1.ParentId = n.BasicGraphNodeId AND c1.NodeType = N'DfOutputElement'
INNER JOIN BIDoc.ModelElements oe ON oe.ModelElementId = c1.SourceElementId
INNER JOIN BIDoc.BasicGraphNodes c2 ON c2.ParentId = c1.BasicGraphNodeId
INNER JOIN BIDoc.ModelElements ce ON ce.ModelElementId = c2.SourceElementId

WHERE oe.Type = N'CD.DLS.Model.Mssql.Ssis.DfOutputElement' 
AND JSON_VALUE(oe.ExtendedProperties, '$.OutputType') = N'0' 
AND ce.Type = N'CD.DLS.Model.Mssql.Ssis.DfColumnElement'


)
GO
PRINT N'Creating [Adm].[sp_SetProjectPowerBiComponents]...';


GO
CREATE PROCEDURE [Adm].[sp_SetProjectPowerBiComponents]
	@projectconfigid UNIQUEIDENTIFIER,
	@components Adm.UDTT_PowerBiProjectComponents READONLY
AS
DELETE FROM Adm.PowerBiProjectComponents WHERE ProjectConfig_ProjectConfigId = @projectconfigid
INSERT INTO Adm.PowerBiProjectComponents(
			[RedirectUri]
			,[ApplicationID]
			,[WorkspaceID]
			,[ReportServerURL]
			,[ReportServerFolder]
			,[ProjectConfig_ProjectConfigId]			
		   )
		   SELECT
		   RedirectUri
		   ,ApplicationID
		   ,WorkspaceID
		   ,ReportServerURL
		   ,ReportServerFolder
		   ,@projectconfigid
		   FROM @components
GO
PRINT N'Altering [BIDoc].[sp_BuildHighLevelGraph]...';


GO
ALTER PROCEDURE [BIDoc].[sp_BuildHighLevelGraph]
	--DECLARE 
	@projectconfigid UNIQUEIDENTIFIER --= N'e99a3b4e-7f04-4b98-9780-10e71e6258cf'
AS

DECLARE @grphDf NVARCHAR(50) = N'DataFlow'
DECLARE @grphHigh NVARCHAR(50) = N'DFHigh'
DECLARE @grphMid NVARCHAR(50) = N'DFMedium'


DECLARE @highNodes TABLE
(
 SourceGraphNodeId INT,
 [Name] NVARCHAR(MAX),
 NodeType NVARCHAR(MAX),
 Description NVARCHAR(MAX),
 ParentId INT NULL,
 SourceElementId INT
)


DELETE l 
FROM BIDoc.BasicGraphLinks l
INNER JOIN BIDoc.BasicGraphNodes n ON l.NodeFromId = n.BasicGraphNodeId
WHERE n.ProjectConfigId = @projectconfigid AND n.GraphKind IN (@grphHigh/*, @grphMid*/)

DELETE FROM BIDoc.BasicGraphNodes
WHERE ProjectConfigId = @projectconfigid AND GraphKind IN (@grphHigh/*, @grphMid*/)

-- the nodes to be included

INSERT INTO @highNodes(SourceGraphNodeId, [Name], NodeType, Description, ParentId, SourceElementId) 
SELECT n.BasicGraphNodeId, n.Name, n.NodeType, n.Name, NULL ParentId, n.SourceElementId
FROM BIDoc.BasicGraphNodes n
INNER JOIN BIDoc.ModelElements e ON e.ModelElementId = n.SourceElementId
WHERE e.Type = N'CD.DLS.Model.Mssql.Db.DatabaseElement' AND n.ProjectConfigId = @projectconfigid AND n.GraphKind = @grphDf


INSERT INTO @highNodes(SourceGraphNodeId, [Name], NodeType, Description, ParentId, SourceElementId) 
SELECT n.BasicGraphNodeId, n.Name, n.NodeType, fld.Name + N'/' + n.Name, NULL ParentId, n.SourceElementId
FROM BIDoc.BasicGraphNodes n
INNER JOIN BIDoc.BasicGraphNodes fld ON fld.BasicGraphNodeId = n.ParentId
INNER JOIN BIDoc.ModelElements e ON e.ModelElementId = n.SourceElementId
WHERE e.Type = N'CD.DLS.Model.Mssql.Ssis.ProjectElement' AND n.ProjectConfigId = @projectconfigid AND n.GraphKind = @grphDf

INSERT INTO @highNodes(SourceGraphNodeId, [Name], NodeType, Description, ParentId, SourceElementId) 
SELECT n.BasicGraphNodeId, n.Name, n.NodeType, n.Name Description, NULL ParentId, n.SourceElementId
FROM BIDoc.BasicGraphNodes n
INNER JOIN BIDoc.BasicGraphNodes fld ON fld.BasicGraphNodeId = n.ParentId
INNER JOIN BIDoc.ModelElements e ON e.ModelElementId = n.SourceElementId
WHERE e.Type = N'CD.DLS.Model.Mssql.Ssas.CubeElement' AND n.ProjectConfigId = @projectconfigid AND n.GraphKind = @grphDf

INSERT INTO @highNodes(SourceGraphNodeId, [Name], NodeType, Description, ParentId, SourceElementId) 
SELECT n.BasicGraphNodeId, n.Name, n.NodeType, n.Name Description, NULL ParentId, n.SourceElementId
FROM BIDoc.BasicGraphNodes n
INNER JOIN BIDoc.BasicGraphNodes fld ON fld.BasicGraphNodeId = n.ParentId
INNER JOIN BIDoc.ModelElements e ON e.ModelElementId = n.SourceElementId
WHERE e.Type = N'CD.DLS.Model.Mssql.Pbi.TenantElement' AND n.ProjectConfigId = @projectconfigid AND n.GraphKind = @grphDf


;WITH ssrsFolders AS
(
SELECT n.BasicGraphNodeId, n.Name, n.NodeType, n.Name Description, NULL ParentId, n.SourceElementId, n.ParentId CurrentParent
FROM BIDoc.BasicGraphNodes n
INNER JOIN BIDoc.ModelElements e ON e.ModelElementId = n.SourceElementId
LEFT JOIN BIDoc.BasicGraphNodes chf ON chf.ParentId = n.BasicGraphNodeId AND chf.NodeType = N'FolderElement'
WHERE e.Type = N'CD.DLS.Model.Mssql.Ssrs.FolderElement' AND n.ProjectConfigId = @projectconfigid AND n.GraphKind = @grphDf AND chf.BasicGraphNodeId IS NULL

UNION ALL

SELECT f.BasicGraphNodeId, f.Name, f.NodeType, p.Name + N'/' + f.Description, f.ParentId, f.SourceElementId, p.ParentId
FROM ssrsFolders f
INNER JOIN BIDoc.BasicGraphNodes p ON p.BasicGraphNodeId = f.CurrentParent
)
INSERT INTO @highNodes(SourceGraphNodeId, [Name], NodeType, Description, ParentId, SourceElementId) 
SELECT BasicGraphNodeId, Name, NodeType, REPLACE(Description, N'//', N'') Description,ParentId, SourceElementId 
FROM ssrsFolders WHERE Description LIKE '/%'


INSERT INTO BIDoc.BasicGraphNodes(Name, NodeType, Description, ParentId, GraphKind, ProjectConfigId, SourceElementId)
SELECT DISTINCT Name, NodeType, Description, ParentId, @grphHigh, @projectconfigid, SourceElementId FROM @highNodes


;WITH descendantMap AS
(
SELECT hn.SourceGraphNodeId HighNode, hn.SourceGraphNodeId LowNode FROM @highNodes hn

UNION ALL

SELECT m.HighNode, c.BasicGraphNodeId LowNode FROM descendantMap m
INNER JOIN BIDoc.BasicGraphNodes c ON c.ParentId = m.LowNode
)
,links AS(
SELECT src.HighNode SrcSrcNode, tgt.HighNode TgtSrcNode, COUNT(*) Strength 
FROM descendantMap src
INNER JOIN BIDoc.BasicGraphLinks l ON l.NodeFromId = src.LowNode
INNER JOIN descendantMap tgt ON l.NodeToId = tgt.LowNode
WHERE l.LinkType = N'DataFlow' AND src.HighNode <> tgt.HighNode
GROUP BY src.HighNode, tgt.HighNode

)
INSERT INTO BIDoc.BasicGraphLinks
(NodeFromId, NodeToId, LinkType, ExtendedProperties)
SELECT 
--*
srcn.BasicGraphNodeId, tgtn.BasicGraphNodeId, N'DataFlow', N'{"Strength":' + CONVERT(NVARCHAR(20), l.Strength) + N'}'
FROM links l
INNER JOIN @highNodes srcHn ON srcHn.SourceGraphNodeId = l.SrcSrcNode
INNER JOIN @highNodes tgtHn ON tgtHn.SourceGraphNodeId = l.TgtSrcNode
INNER JOIN BIDoc.BasicGraphNodes srcn ON srcn.SourceElementId = srcHn.SourceElementId AND srcn.GraphKind = @grphHigh
INNER JOIN BIDoc.BasicGraphNodes tgtn ON tgtn.SourceElementId = tgtHn.SourceElementId AND tgtn.GraphKind = @grphHigh
OPTION(MAXRECURSION 10000)

--SELECT * FROM @highNodes

-- delete nodes without links
DELETE n FROM BIDoc.BasicGraphNodes n
LEFT JOIN BIDoc.BasicGraphLinks l ON l.NodeFromId = n.BasicGraphNodeId
LEFT JOIN BIDoc.BasicGraphLinks l2 ON l2.NodeToId = n.BasicGraphNodeId
WHERE l.BasicGraphLinkId IS NULL AND l2.BasicGraphLinkId IS NULL AND n.ProjectConfigId = @projectconfigid AND n.GraphKind = @grphHigh

--SELECT src.Description, tgt.Description, l.ExtendedProperties FROM BIDoc.BasicGraphNodes src
--INNER JOIN BIDoc.BasicGraphLinks l ON l.NodeFromId = src.BasicGraphNodeId
--INNER JOIN BIDoc.BasicGraphNodes tgt ON l.NodeToId = tgt.BasicGraphNodeId
--WHERE src.GraphKind = N'DFHigh'
GO
PRINT N'Altering [BIDoc].[sp_CreateDataFlowGraph]...';


GO
ALTER PROCEDURE [BIDoc].[sp_CreateDataFlowGraph]
	@projectconfigid UNIQUEIDENTIFIER --= N'e99a3b4e-7f04-4b98-9780-10e71e6258cf'
AS

----------------------
-- clear higher ancestors (reference nodes)

DECLARE @rc INT = 1
WHILE @rc > 0
BEGIN
	DELETE TOP (10000) a FROM [BIDoc].[HigherLevelElementAncestors] a
	INNER JOIN BIDoc.ModelElements e ON a.SouceElementId = e.ModelElementId
	WHERE e.ProjectConfigId = @projectConfigId

	SELECT @rc = @@ROWCOUNT
END

CREATE TABLE #dataflowLinks
(
RuleName NVARCHAR(MAX),
ElementFromId INT,
ElementToId INT,
)


-------------------------

DECLARE @graphKind NVARCHAR(50) = N'DataFlow'

---------------------- clear graph

EXEC BIDoc.sp_ClearGraph @projectconfigid, @graphKind

------------------------ replicate graph

INSERT INTO BIDoc.BasicGraphNodes
(
Name, 
NodeType, 
ParentId, 
GraphKind, 
ProjectConfigId, 
SourceElementId, 
TopologicalOrder
)
SELECT
e.Caption,
REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(e.Type,
N'CD.DLS.Model.Mssql', N''), N'.Db.', N''), N'.Ssis.', N''), N'.Ssas.', N''), N'.Ssrs.', N''), N'.Agent.', N''), N'.Tabular.', N''), N'.Pbi.', N'') NodeType,
NULL,
@graphKind,
e.ProjectConfigId,
e.ModelElementId,
0 TopologicalOrder
FROM BIDoc.ModelElements e
WHERE e.ProjectConfigId = @projectconfigid

UPDATE en 
SET ParentId = pen.BasicGraphNodeId 
FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.Type = N'parent'
INNER JOIN BIDoc.ModelElements pe ON pe.ModelElementId = l.ElementToId
INNER JOIN BIDoc.BasicGraphNodes en ON en.SourceElementId = e.ModelElementId
INNER JOIN BIDoc.BasicGraphNodes pen ON pen.SourceElementId = pe.ModelElementId
WHERE e.ProjectConfigId = @projectConfigId
AND pe.ProjectConfigId = @projectConfigId
AND en.GraphKind = @graphKind

INSERT INTO BIDoc.BasicGraphLinks
(LinkType, NodeFromId, NodeToId)
SELECT 
N'Parent', n.BasicGraphNodeId, n.ParentId
FROM BIDoc.BasicGraphNodes n 
WHERE n.ProjectConfigId = @projectConfigId
AND n.ParentId IS NOT NULL

--------------------------- 
-- MssqlReferenceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'MssqlReferenceDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Reference'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type <> N'CD.DLS.Model.Mssql.Db.SqlDmlTargetReferenceElement'

-----------------
-- MssqlDmlTargetReferenceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'MssqlDmlTargetReferenceDataFlowRule', e.ModelElementId, re.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Reference'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Db.SqlDmlTargetReferenceElement'


-----------------
-- MssqlDmlSourceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'MssqlDmlSourceDataFlowRule', e.ModelElementId, re.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'TargetReference'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Db.SqlDmlSourceElement'


-----------------
-- MssqlNAryOperationOperandRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'MssqlNAryOperationOperandRule', e.ModelElementId, re.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'OperationOutputColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOperandColumnElement'


-----------------
-- SsisDfExternalColumnsDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsisDfExternalColumnsDataFlowRule_ExternalDestinationColumn', e.ModelElementId, re.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'ExternalDestinationColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssis.DfColumnElement'

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsisDfExternalColumnsDataFlowRule_ExternalSourceColumn', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'ExternalSourceColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssis.DfColumnElement'

-----------------
-- SsisDfTransformationDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsisDfTransformationDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'SourceDfColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type IN(N'CD.DLS.Model.Mssql.Ssis.DfColumnElement', N'CD.DLS.Model.Mssql.Ssis.DfUnpivotSourceReferenceElement', N'CD.DLS.Model.Mssql.Ssis.DfLookupColumnElement')


-----------------
-- SsisDfSourceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsisDfSourceDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'SourceConnection'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssis.DfSourceElement'


-----------------
-- SsisDfUnpivotSourceDataFlowRuleTPK

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsisDfUnpivotSourceDataFlowRuleTPK', e.ModelElementId, re.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'TargetPivotKeyColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssis.DfUnpivotSourceReferenceElement'


-----------------
-- SsisDfUnpivotSourceDataFlowRuleTV

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsisDfUnpivotSourceDataFlowRuleTV', e.ModelElementId, re.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'TargetValueColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssis.DfUnpivotSourceReferenceElement'


-----------------
-- SsisDfAggregationDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsisDfAggregationDataFlowRule', ls.ElementToId, lt.ElementToId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks ls ON e.ModelElementId = ls.ElementFromId AND ls.[Type] = N'SourceDfColumn'
INNER JOIN BIDoc.ModelLinks lt ON e.ModelElementId = lt.ElementFromId AND lt.[Type] = N'TargetDfColumn'
--INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssis.DfColumnAggregationLinkElement'

-----------------
-- SsisDfLookupOutputJoinReferenceRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsisDfLookupOutputJoinReferenceRule', ls.ElementToId, lt.ElementToId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks ls ON e.ModelElementId = ls.ElementFromId AND ls.[Type] = N'InputJoinColumn'
INNER JOIN BIDoc.ModelLinks lt ON e.ModelElementId = lt.ElementFromId AND lt.[Type] = N'OutputColumn'
--INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssis.DfLookupOutputJoinReferenceElement'


-----------------
-- SsasDsvSourceColumnDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsasDsvSourceColumnDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Source'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.DatasourceViewColumnElement'

-----------------
-- SsasDimensionKeyColumnDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsasDimensionKeyColumnDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'DsvColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.KeyColumnElement'


-----------------
-- SsasDimensionNameColumnDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsasDimensionNameColumnDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'DsvColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.NameColumnElement'


-----------------
-- SsasHierarchyLevelDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsasHierarchyLevelDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Attribute'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.HierarchyLevelElement'


-----------------
-- SsasPhysicalMeasureDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsasPhysicalMeasureDataFlowRule', pse.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks pl ON e.ModelElementId = pl.ElementToId AND pl.[Type] = N'parent'
INNER JOIN BIDoc.ModelElements pse ON pse.ModelElementId = pl.ElementFromId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement'
AND pse.Type = N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasurePartitionSourceElement'


-----------------
-- SsasPhysicalMeasurePartitionSourceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsasPhysicalMeasurePartitionSourceDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Source'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasurePartitionSourceElement'

-----------------
-- SsasPartitionColumnDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsasPartitionColumnDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Source'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.PartitionColumnElement'


-----------------
-- SsasCubeDimensionDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsasCubeDimensionDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'DatabaseDimension'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.CubeDimensionElement'


-------------------
---- CubeDimensionAttributeDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'CubeDimensionAttributeDataFlowRule', re.ModelElementId, e.ModelElementId 
FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'DatabaseDimensionAttribute'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.CubeDimensionAttributeElement'


-------------------
---- CubeDimensionHierarchyDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'CubeDimensionHierarchyDataFlowRule', re.ModelElementId, e.ModelElementId 
FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'DatabaseDimensionHierarchy'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.CubeDimensionHierarchyElement'


-------------------
---- CubeDimensionHierarchyLevelDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'CubeDimensionHierarchyLevelDataFlowRule', re.ModelElementId, e.ModelElementId 
FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Attribute'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.CubeDimensionHierarchyLevelElement'


-----------------
-- SsrsDataSetFieldDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsrsDataSetFieldDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Source'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssrs.DataSetFieldElement'


-----------------
-- SsrsReportParameterValidValuesDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsrsReportParameterValidValuesDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'ValueField'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssrs.ReportParameterValidValuesDataSetElement'


-----------------
-- SsrsReportParameterDefaultValuesDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'SsrsReportParameterDefaultValuesDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'ValueField'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssrs.ReportParameterDefaultValuesDataSetElement'

-------------------------
-- TabularPartitionColumnSourceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'TabularPartitionColumnSourceDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'SourceElement'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Tabular.SsasTabularPartitionColumnElement'

-------------------------
-- TabularPartitionColumnTargetTableColumnDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'TabularPartitionColumnTargetTableColumnDataFlowRule', e.ModelElementId, re.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'TargetTableColumn'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Tabular.SsasTabularPartitionColumnElement'

-------------------------
-- DaxTableReferenceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'DaxTableReferenceDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Reference'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.DaxTableReferenceElement'

-------------------------
-- DaxColumnReferenceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'DaxColumnReferenceDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Reference'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.DaxColumnReferenceElement'


-------------------------
-- DaxLinkDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'DaxLinkDataFlowRule', sre.ModelElementId, tre.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks sl ON e.ModelElementId = sl.ElementFromId AND sl.[Type] = N'Source'
INNER JOIN BIDoc.ModelElements sre ON sre.ModelElementId = sl.ElementToId
INNER JOIN BIDoc.ModelLinks tl ON e.ModelElementId = tl.ElementFromId AND tl.[Type] = N'Target'
INNER JOIN BIDoc.ModelElements tre ON tre.ModelElementId = tl.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Mssql.Ssas.DaxDataFlowLinkElement'

-------------------------
-- DaxLinkTargetDataFlowRule

--INSERT INTO #dataflowLinks
--(RuleName, ElementFromId, ElementToId)

--SELECT DISTINCT N'DaxLinkTargetDataFlowRule', e.ModelElementId, re.ModelElementId FROM BIDoc.ModelElements e
--INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'Target'
--INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
--AND e.ProjectConfigId = @projectConfigId
--AND e.Type = N'CD.DLS.Model.Mssql.Ssas.DaxDataFlowLinkElement'

-------------------------
--PivotTableFieldSourceDataFlowRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'PivotTableFieldSourceDataFlowRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'SourceField'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Business.Excel.PivotTableFieldElement'

-------------------------
--PivotTableFieldVaulesFilterSourceMeasureRule

INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT N'PivotTableFieldVaulesFilterSourceMeasureRule', re.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks l ON e.ModelElementId = l.ElementFromId AND l.[Type] = N'SourceMeasure'
INNER JOIN BIDoc.ModelElements re ON re.ModelElementId = l.ElementToId
AND e.ProjectConfigId = @projectConfigId
AND e.Type = N'CD.DLS.Model.Business.Excel.PivotTableValuesFilterElement'

--
INSERT INTO #dataflowLinks
(RuleName, ElementFromId, ElementToId)

SELECT DISTINCT  N'PowerBIDataFlowRule',pse.ModelElementId, e.ModelElementId FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelLinks pl ON e.ModelElementId = pl.ElementToId AND pl.[Type] = N'parent'
INNER JOIN BIDoc.ModelElements pse ON pse.ModelElementId = pl.ElementFromId
AND 
(
e.Type = N'CD.DLS.Model.Mssql.Pbi.ReportSectionElement'
OR e.Type = N'CD.DLS.Model.Mssql.Pbi.ReportElement'
OR e.Type = N'CD.DLS.Model.Mssql.Pbi.VisualElement'
OR e.Type = N'CD.DLS.Model.Mssql.Pbi.ConnectionElement'
OR e.Type = N'CD.DLS.Model.Mssql.Pbi.PbiTableElement'
)


--- add DF links to the graph

;WITH dataflowLinks AS (
SELECT DISTINCT ElementFromId, ElementToId FROM #dataflowLinks
)
INSERT INTO BIDoc.BasicGraphLinks
(LinkType, NodeFromId, NodeToId)
SELECT
N'DataFlow',
nf.BasicGraphNodeId,
nt.BasicGraphNodeId
FROM dataflowLinks l
INNER JOIN BIDoc.BasicGraphNodes nf ON nf.SourceElementId = l.ElementFromId
INNER JOIN BIDoc.BasicGraphNodes nt ON nt.SourceElementId = l.ElementToId
WHERE nf.GraphKind = @graphKind AND nt.GraphKind = @graphKind

DROP TABLE #dataflowLinks
GO
PRINT N'Altering [BIDoc].[sp_PropagateDataFlowVertically]...';


GO
ALTER PROCEDURE [BIDoc].[sp_PropagateDataFlowVertically]
	--DECLARE 
	@projectconfigid UNIQUEIDENTIFIER --= N'e99a3b4e-7f04-4b98-9780-10e71e6258cf'
AS


	DECLARE @sourcegraphkind NVARCHAR(50) = N'DataFlow'
	DECLARE @linktype NVARCHAR(50) = N'DataFlow'
	DECLARE @graphkind NVARCHAR(50) = N'DataFlow'

-- df column sources - propagate down
DECLARE @dfPropSourceCount INT
DECLARE @dfPropTargetCount INT


DELETE FROM BIDoc.BasicGraphLinks WHERE NodeFromId = NodeToId

;WITH dfPropSources AS
(
SELECT l.NodeFromId, l.NodeToId FROM BIDoc.BasicGraphNodes n 
INNER JOIN BIDoc.BasicGraphLinks l ON n.BasicGraphNodeId = l.NodeToId AND l.LinkType = @linktype
WHERE n.ProjectConfigId = @projectconfigid AND n.GraphKind = @graphkind AND n.NodeType IN ( N'DfColumnElement', N'DfUnpivotSourceReferenceElement')
UNION ALL
SELECT n.BasicGraphNodeId NodeFromId, ps.NodeToId FROM dfPropSources ps
INNER JOIN BIDoc.BasicGraphNodes n ON n.ParentId = ps.NodeFromId
)
SELECT @dfPropSourceCount = COUNT(*) FROM dfPropSources


PRINT 'Propagated DF source links - ' + CONVERT(VARCHAR(10), @dfPropSourceCount)


--EXEC sp_sequence_get_range @sequence_name = N'BIDoc.BasicGraphLinksSequence', @range_size = @dfPropSourceCount, @range_first_value = @linkSequenceStartVariant OUTPUT
--	SET @linkSequenceStart = CONVERT(INT, @linkSequenceStartVariant)

;WITH dfPropSources AS
(
SELECT l.NodeFromId, l.NodeToId FROM BIDoc.BasicGraphNodes n 
INNER JOIN BIDoc.BasicGraphLinks l ON n.BasicGraphNodeId = l.NodeToId AND l.LinkType = @linktype
WHERE n.ProjectConfigId = @projectconfigid AND n.GraphKind = @graphkind AND n.NodeType IN ( N'DfColumnElement', N'DfUnpivotSourceReferenceElement')
UNION ALL
SELECT n.BasicGraphNodeId NodeFromId, ps.NodeToId FROM dfPropSources ps
INNER JOIN BIDoc.BasicGraphNodes n ON n.ParentId = ps.NodeFromId
)
INSERT INTO BIDoc.BasicGraphLinks(
			--[BasicGraphLinkId]
           --,
		   [LinkType]
           ,[NodeFromId]
           ,[NodeToId]
		   )
	SELECT 
	--ROW_NUMBER() OVER(ORDER BY s.NodeFromId) + @linkSequenceStart - 1
	--,
	@linktype
	,s.NodeFromId
	,s.NodeToId
	FROM dfPropSources s

;WITH dfPropTargets AS
(
SELECT l.NodeFromId, l.NodeToId FROM BIDoc.BasicGraphNodes n 
INNER JOIN BIDoc.BasicGraphLinks l ON n.BasicGraphNodeId = l.NodeFromId AND l.LinkType = @linktype
WHERE n.ProjectConfigId = @projectconfigid AND n.GraphKind = @graphkind AND n.NodeType IN ( N'DfColumnElement', N'DfUnpivotSourceReferenceElement')
UNION ALL
SELECT pt.NodeFromId NodeFromId, n.BasicGraphNodeId NodeToId FROM dfPropTargets pt
INNER JOIN BIDoc.BasicGraphNodes n ON n.ParentId = pt.NodeToId
)
SELECT @dfPropTargetCount = COUNT(*) FROM dfPropTargets

PRINT 'Propagated DF target links - ' + CONVERT(VARCHAR(10), @dfPropTargetCount)

--EXEC sp_sequence_get_range @sequence_name = N'BIDoc.BasicGraphLinksSequence', @range_size = @dfPropTargetCount, @range_first_value = @linkSequenceStartVariant OUTPUT
--	SET @linkSequenceStart = CONVERT(INT, @linkSequenceStartVariant)

;WITH dfPropTargets AS
(
SELECT l.NodeFromId, l.NodeToId FROM BIDoc.BasicGraphNodes n 
INNER JOIN BIDoc.BasicGraphLinks l ON n.BasicGraphNodeId = l.NodeFromId AND l.LinkType = @linktype
WHERE n.ProjectConfigId = @projectconfigid AND n.GraphKind = @graphkind AND n.NodeType IN ( N'DfColumnElement', N'DfUnpivotSourceReferenceElement')
UNION ALL
SELECT pt.NodeFromId NodeFromId, n.BasicGraphNodeId NodeToId FROM dfPropTargets pt
INNER JOIN BIDoc.BasicGraphNodes n ON n.ParentId = pt.NodeToId
)
INSERT INTO BIDoc.BasicGraphLinks(
			--[BasicGraphLinkId]
           --,
		   [LinkType]
           ,[NodeFromId]
           ,[NodeToId]
		   )
	SELECT DISTINCT
	--ROW_NUMBER() OVER(ORDER BY t.NodeToId) + @linkSequenceStart - 1
	--,
	@linktype
	,t.NodeFromId
	,t.NodeToId
	FROM dfPropTargets t
--N'DimensionAttributeElement'


DECLARE @dfPropSourcesUpCount INT


;WITH dfPropMap AS
(
SELECT n.BasicGraphNodeId OriginalNodeId, n.BasicGraphNodeId, n.Description NodeDef FROM BIDoc.BasicGraphNodes n
INNER JOIN BIDoc.ModelElements e ON e.ModelElementId = n.SourceElementId 
WHERE (n.NodeType IN (N'DimensionAttributeElement'/*, N'SqlScriptElement'*/)
OR
(n.NodeType = N'SqlScriptElement' AND e.RefPath LIKE '%/View%')
) AND n.GraphKind = @graphkind
AND n.ProjectConfigId = @projectconfigid
UNION ALL

SELECT dfPropMap.OriginalNodeId, n.BasicGraphNodeId, dfPropMap.NodeDef FROM BIDoc.BasicGraphNodes n
INNER JOIN dfPropMap ON n.ParentId = dfPropMap.BasicGraphNodeId AND (n.NodeType <> N'SqlScriptElement' OR n.Description = dfPropMap.NodeDef)
)
SELECT DISTINCT l.NodeFromId, pm.OriginalNodeId NodeToId 
INTO #propUpTargets
FROM BIDoc.BasicGraphLinks l
INNER JOIN dfPropMap pm ON pm.BasicGraphNodeId = l.NodeToId AND l.LinkType = @linktype
LEFT JOIN BIDoc.BasicGraphLinks lr ON lr.NodeFromId = l.NodeFromId AND lr.NodeToId = pm.OriginalNodeId AND lr.LinkType = @linktype
WHERE lr.BasicGraphLinkId IS NULL AND l.NodeFromId <> pm.OriginalNodeId


DECLARE @propUpCount INT  = (SELECT COUNT(*) FROM #propUpTargets)
PRINT 'Target propagation links - ' + CONVERT(VARCHAR(10), @propUpCount)

--EXEC sp_sequence_get_range @sequence_name = N'BIDoc.BasicGraphLinksSequence', @range_size = @propUpCount, @range_first_value = @linkSequenceStartVariant OUTPUT
--	SET @linkSequenceStart = CONVERT(INT, @linkSequenceStartVariant)

INSERT INTO BIDoc.BasicGraphLinks(
			--[BasicGraphLinkId]
           --,
		   [LinkType]
           ,[NodeFromId]
           ,[NodeToId]
		   )
	SELECT DISTINCT
	--ROW_NUMBER() OVER(ORDER BY t.NodeFromId) + @linkSequenceStart - 1
	--,
	@linktype
	,t.NodeFromId
	,t.NodeToId
	FROM #propUpTargets t

------------- SqlScripts with future ------------------

;WITH targetNodes AS(
-- nodes with future - have links leading from them (?)
SELECT DISTINCT tn.BasicGraphNodeId FROM BIDoc.BasicGraphNodes tn
INNER JOIN BIDoc.BasicGraphLinks l ON l.NodeFromId = tn.BasicGraphNodeId 
WHERE tn.ProjectConfigId = @projectconfigid AND tn.GraphKind = @graphkind
AND l.LinkType = @linktype AND tn.NodeType IN( 'SqlScriptElement', N'SqlDmlSourceElement', 
	N'SqlNAryOperationOperandColumnElement', N'SqlNAryOperationOutputColumnElement')
)
,targetDescendants AS
(
SELECT BasicGraphNodeId, BasicGraphNodeId AS DescendantNodeId FROM targetNodes
UNION ALL
SELECT td.BasicGraphNodeId, n.BasicGraphNodeId DescendantNodeId FROM BIDoc.BasicGraphNodes n
INNER JOIN targetDescendants td ON td.DescendantNodeId = n.ParentId
)
-- descendants with lineage - have links leading to them -> ancestors with future will counter-inherit their links
INSERT INTO BIDoc.BasicGraphLinks
(NodeFromId, NodeToId, LinkType)
SELECT DISTINCT l.NodeFromId, td.BasicGraphNodeId NodeToId, @linktype
FROM targetDescendants td
INNER JOIN BIDoc.BasicGraphLinks l ON l.LinkType = @linktype AND l.NodeToId = td.DescendantNodeId
LEFT JOIN BIDoc.BasicGraphLinks exl ON exl.NodeFromId = l.NodeFromId AND exl.NodeToId = td.BasicGraphNodeId AND exl.LinkType = @linktype
WHERE exl.BasicGraphLinkId IS NULL
OPTION(MAXRECURSION  1000)


PRINT CONVERT(NVARCHAR(20), @@ROWCOUNT) + N' new links from SqlScript ancestors ''with future'' propagation'



;WITH targetNodes AS(
-- nodes with future - have links leading from them (?)
SELECT DISTINCT tn.BasicGraphNodeId FROM BIDoc.BasicGraphNodes tn
WHERE tn.ProjectConfigId = @projectconfigid AND tn.GraphKind = @graphkind AND tn.NodeType IN( N'ReportCalculatedMeasureElement', N'CubeCalculatedMeasureElement', N'DimensionAttributeElement')
)
,targetDescendants AS
(
SELECT BasicGraphNodeId, BasicGraphNodeId AS DescendantNodeId FROM targetNodes
UNION ALL
SELECT td.BasicGraphNodeId, n.BasicGraphNodeId DescendantNodeId FROM BIDoc.BasicGraphNodes n
INNER JOIN targetDescendants td ON td.DescendantNodeId = n.ParentId
)
-- descendants with lineage - have links leading to them -> ancestors with future will counter-inherit their links
INSERT INTO BIDoc.BasicGraphLinks
(NodeFromId, NodeToId, LinkType)
SELECT DISTINCT l.NodeFromId, td.BasicGraphNodeId NodeToId, @linktype
FROM targetDescendants td
INNER JOIN BIDoc.BasicGraphLinks l ON l.LinkType = @linktype AND l.NodeToId = td.DescendantNodeId
LEFT JOIN BIDoc.BasicGraphLinks exl ON exl.NodeFromId = l.NodeFromId AND exl.NodeToId = td.BasicGraphNodeId AND exl.LinkType = @linktype
WHERE exl.BasicGraphLinkId IS NULL
OPTION(MAXRECURSION  1000)


PRINT CONVERT(NVARCHAR(20), @@ROWCOUNT) + N' new links from SSAS descendants propagation'


DROP TABLE #propUpTargets


---------------------------------------------------



-- textboxes with lineage
;WITH targetNodes AS(
SELECT DISTINCT tn.BasicGraphNodeId FROM BIDoc.BasicGraphNodes tn
WHERE tn.ProjectConfigId = @projectconfigid AND tn.GraphKind = @graphkind
AND tn.NodeType IN( N'TextBoxElement')
)
,targetDescendants AS
(
SELECT BasicGraphNodeId, BasicGraphNodeId AS DescendantNodeId FROM targetNodes
UNION ALL
SELECT td.BasicGraphNodeId, n.BasicGraphNodeId DescendantNodeId FROM BIDoc.BasicGraphNodes n
INNER JOIN targetDescendants td ON td.DescendantNodeId = n.ParentId
)
-- descendants with lineage - have links leading to them -> ancestors with future will counter-inherit their links
INSERT INTO BIDoc.BasicGraphLinks
(NodeFromId, NodeToId, LinkType)

SELECT DISTINCT l.NodeFromId, td.BasicGraphNodeId NodeToId, @linktype
FROM targetDescendants td
INNER JOIN BIDoc.BasicGraphLinks l ON l.LinkType = @linktype AND l.NodeToId = td.DescendantNodeId
LEFT JOIN BIDoc.BasicGraphLinks exl ON exl.NodeFromId = l.NodeFromId AND exl.NodeToId = td.BasicGraphNodeId AND exl.LinkType = @linktype
WHERE exl.BasicGraphLinkId IS NULL
OPTION(MAXRECURSION  1000)

PRINT CONVERT(NVARCHAR(20), @@ROWCOUNT) + N' new links from textboxes propagation'


-- delete duplicate links
-- (links for which there is an equivalent link (same souce, target, type) with a lower ID)
;WITH fstLnks AS
(
SELECT MIN(l.BasicGraphLinkId) BasicGraphLinkId, l.NodeFromId, l.NodeToId, l.LinkType 
FROM BIDoc.BasicGraphLinks l
INNER JOIN BIDoc.BasicGraphNodes n ON l.NodeFromId = n.BasicGraphNodeId
WHERE n.ProjectConfigId = @projectconfigid
GROUP BY l.NodeFromId, l.NodeToId, l.LinkType
)
DELETE dl FROM BIDoc.BasicGraphLinks dl
INNER JOIN fstLnks f ON f.NodeFromId = dl.NodeFromId AND f.NodeToId = dl.NodeToId AND f.LinkType = dl.LinkType AND dl.BasicGraphLinkId <> f.BasicGraphLinkId


------------- SSAS hierarchies - descendants with lineage ------------------

;WITH targetNodes AS(
-- nodes with future - have links leading from them (?)
SELECT DISTINCT tn.BasicGraphNodeId FROM BIDoc.BasicGraphNodes tn
WHERE tn.ProjectConfigId = @projectconfigid AND tn.GraphKind = @graphkind
AND tn.NodeType IN( 'HierarchyElement')
)
,targetDescendants AS
(
SELECT BasicGraphNodeId, BasicGraphNodeId AS DescendantNodeId FROM targetNodes
UNION ALL
SELECT td.BasicGraphNodeId, n.BasicGraphNodeId DescendantNodeId FROM BIDoc.BasicGraphNodes n
INNER JOIN targetDescendants td ON td.DescendantNodeId = n.ParentId
)
-- descendants with lineage - have links leading to them -> ancestors with future will counter-inherit their links
INSERT INTO BIDoc.BasicGraphLinks
(NodeFromId, NodeToId, LinkType)
SELECT DISTINCT l.NodeFromId, td.BasicGraphNodeId NodeToId, @linktype
FROM targetDescendants td
INNER JOIN BIDoc.BasicGraphLinks l ON l.LinkType = @linktype AND l.NodeToId = td.DescendantNodeId
LEFT JOIN BIDoc.BasicGraphLinks exl ON exl.NodeFromId = l.NodeFromId AND exl.NodeToId = td.BasicGraphNodeId AND exl.LinkType = @linktype
WHERE exl.BasicGraphLinkId IS NULL
OPTION(MAXRECURSION  1000)


PRINT CONVERT(NVARCHAR(20), @@ROWCOUNT) + N' new links from hierarchy descendants propagation'
GO
PRINT N'Altering [Inspect].[sp_FillHighLevelSolutionTree]...';


GO
ALTER PROCEDURE [Inspect].[sp_FillHighLevelSolutionTree]
@projectConfigId UNIQUEIDENTIFIER
AS

DELETE FROM Inspect.HighLevelSolutionTrees WHERE ProjectConfigId = @projectConfigId

;
WITH elemTree AS(
	SELECT e.ModelElementId, e.Caption, e.Type, e.RefPath, 0 ParentLevel
	FROM BIDoc.ModelElements e 
	WHERE e.ProjectConfigId = @projectConfigId AND e.Type IN (
	N'CD.DLS.Model.Mssql.Ssrs.ReportElement',
	N'CD.DLS.Model.Mssql.Ssis.PackageElement',
	N'CD.DLS.Model.Mssql.Ssas.CubeElement',
	N'CD.DLS.Model.Mssql.Pbi.ReportElement',
	N'CD.DLS.Model.Mssql.Ssas.DimensionElement',
	N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement',
	N'CD.DLS.Model.Mssql.Db.ViewElement',
	N'CD.DLS.Model.Mssql.Db.SchemaTableElement',
	N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement',
	N'CD.DLS.Model.Mssql.Db.ProcedureElement',
	N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement'
	)

	UNION ALL

	SELECT e.ModelElementId, e.Caption, e.Type, e.RefPath, ParentLevel + 1
	FROM elemTree t
	INNER JOIN BIDoc.ModelLinks l ON l.ElementFromId = t.ModelElementId AND l.Type = N'parent'
	INNER JOIN BIDoc.ModelElements e ON e.ModelElementId = l.ElementToId
)
,x AS(

SELECT ModelElementId, Caption, elemTree.[Type], td.TypeDescription, MAX(ParentLevel) MaxParentLevel, RefPath
FROM elemTree
INNER JOIN BIDoc.ModelElementTypeDescriptions td ON [Type] = td.ElementType
GROUP BY ModelElementId, Caption, elemTree.[Type], td.TypeDescription, RefPath
)

INSERT INTO Inspect.HighLevelSolutionTrees
(ProjectConfigId, ModelElementId, Caption, [Type], TypeDescription, MaxParentLevel, ParentElementId, RefPath)

SELECT @projectConfigId, ModelElementId, Caption, x.[Type], TypeDescription, MaxParentLevel, l.ElementToId ParentElementId, RefPath
FROM x
LEFT JOIN BIDoc.ModelLinks l ON l.ElementFromId = ModelElementId AND l.Type = N'parent'
GO
PRINT N'Altering [Search].[sp_FindRootElements]...';


GO
ALTER PROCEDURE [Search].[sp_FindRootElements]
@projectConfigId UNIQUEIDENTIFIER
AS

DELETE FROM Search.RootElements WHERE ProjectConfigId = @projectConfigId

INSERT INTO Search.RootElements
(
ProjectConfigId,
ModelElementId,
Caption
)

SELECT @projectConfigId, e.ModelElementId, dp.DescriptivePath 
FROM BIDoc.ModelElements e
INNER JOIN BIDoc.ModelElementDescriptivePaths dp ON e.ModelElementId = dp.ModelElementId
LEFT JOIN BIDoc.ModelLinks pl ON pl.Type = N'parent' AND pl.ElementFromId = e.ModelElementId
LEFT JOIN BIDoc.ModelElements parentFolder ON parentFolder.ModelElementId = pl.ElementToId AND parentFolder.Type = N'CD.DLS.Model.Mssql.Ssrs.FolderElement'
WHERE e.[Type] IN (
 N'CD.DLS.Model.Mssql.Db.DatabaseElement'
 ,N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement'
 ,N'CD.DLS.Model.Mssql.Ssis.ProjectElement'
  ,N'CD.DLS.Model.Mssql.Pbi.TenantElement'
 ,N'CD.DLS.Model.Mssql.Ssrs.FolderElement'
 ,N'CD.DLS.Model.Business.Organization.BusinessRootElement')
AND parentFolder.ModelElementId IS NULL
AND e.ProjectConfigId = @projectConfigId
GO
PRINT N'Altering [Search].[sp_IndexFulltext]...';


GO
ALTER PROCEDURE [Search].[sp_IndexFulltext]
@projectConfigId UNIQUEIDENTIFIER
AS

BEGIN

DELETE fts FROM Search.FullTextSearch fts
--INNER JOIN BIDoc.ModelElements e ON e.ModelElementId = fts.ModelElementId
--WHERE e.ProjectConfigId = @projectConfigId
WHERE fts.ProjectConfigId = @projectConfigId

CREATE TABLE #searchTypes (TypeName NVARCHAR(MAX), SearchPriority INT)

INSERT INTO #searchTypes
(
    TypeName,
    SearchPriority
)
VALUES 

	(N'CD.DLS.Model.Mssql.Ssrs.ReportElement', 10),	
	(N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement', 5),
	(N'CD.DLS.Model.Mssql.Ssis.PackageElement', 7),
	(N'CD.DLS.Model.Mssql.Ssas.CubeElement', 3),
	(N'CD.DLS.Model.Mssql.Db.DatabaseElement', 3),
	(N'CD.DLS.Model.Mssql.Ssis.ProjectElement', 2),
	(N'CD.DLS.Model.Mssql.Ssas.DimensionElement', 7),
	--(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement', 1),
	(N'CD.DLS.Model.Mssql.Db.ViewElement', 8),
	(N'CD.DLS.Model.Mssql.Db.SchemaTableElement', 9),
	--(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement', 6),
	(N'CD.DLS.Model.Mssql.Db.ProcedureElement', 5),
	(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement', 9),
	--(N'CD.DLS.Model.Mssql.Ssas.CalculatedMeasureElement', 9),
	(N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement', 9),
	(N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement', 5),
	(N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement', 8),
	(N'CD.DLS.Model.Mssql.Db.ColumnElement', 7),

	(N'CD.DLS.Model.Business.Excel.PivotTableTemplateElement', 10),

	(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', 9),
	(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement', 8),

	(N'CD.DLS.Model.Mssql.Pbi.TenantElement', 10),
	(N'CD.DLS.Model.Mssql.Pbi.ReportElement', 10),
	(N'CD.DLS.Model.Mssql.Pbi.ReportSectionElement',8),
	(N'CD.DLS.Model.Mssql.Pbi.VisualElement', 5),
	(N'CD.DLS.Model.Mssql.Pbi.ConnectionElement', 5),
	(N'CD.DLS.Model.Mssql.Pbi.PbiTableElement', 7),
	(N'CD.DLS.Model.Mssql.Pbi.PbiColumnElement', 7)




	

INSERT INTO Search.FulltextSearch(ModelElementID, ElementName, ElementNameSplit, SearchPriority,
[TypeDescription], [DescriptiveRootPath], [ElementType], ProjectConfigId, [RefPath]
)
SELECT e.ModelElementId, e.Caption, adm.f_SplitCamelCase(e.Caption), st.SearchPriority,
td.TypeDescription, dscPth.DescriptiveRootPath, e.Type, @projectConfigId, e.RefPath
FROM BIDoc.ModelElements e 
INNER JOIN #searchTypes st ON e.Type = st.TypeName
INNER JOIN BIDoc.ModelElementDescriptivePaths dscPth ON dscPth.ModelElementId = e.ModelElementId
INNER JOIN BIDoc.ModelElementTypeDescriptions td ON td.ElementType = e.[Type]
WHERE e.ProjectConfigId = @projectConfigId

;WITH assignments AS
(
SELECT DISTINCT fts.ModelElementId, 
SUBSTRING(
        (
            SELECT ', ' + fv.Value AS [text()]
            FROM Annotate.FieldValues fv
            WHERE fv.AnnotationElementId = ae.AnnotationElementId
            AND fv.Value <> N''
			FOR XML PATH ('')
        ), 2, 10000) [BusinessValues]

FROM Search.FulltextSearch AS fts
LEFT JOIN Annotate.AnnotationElements ae ON fts.ModelElementId = ae.ModelElementId
WHERE ae.IsCurrentVersion = N'1'
AND ae.ProjectConfigId = @projectConfigId
)
UPDATE fts SET BusinessFields = a.BusinessValues 
FROM Search.FulltextSearch fts
INNER JOIN assignments a ON a.ModelElementId = fts.ModelElementId

ALTER FULLTEXT CATALOG fulltext_default REBUILD

DROP TABLE #searchTypes

END
GO
PRINT N'Refreshing [Adm].[sp_DeleteProjectConfig]...';


GO
EXECUTE sp_refreshsqlmodule N'[Adm].[sp_DeleteProjectConfig]';


GO
PRINT N'Refreshing [BIDoc].[sp_BuildAggregations]...';


GO
EXECUTE sp_refreshsqlmodule N'[BIDoc].[sp_BuildAggregations]';


GO
/*
Post-Deployment Script Template							
--------------------------------------------------------------------------------------
 This file contains SQL statements that will be appended to the build script.		
 Use SQLCMD syntax to include a file in the post-deployment script.			
 Example:      :r .\myfile.sql								
 Use SQLCMD syntax to reference a variable in the post-deployment script.		
 Example:      :setvar TableName MyTable							
               SELECT * FROM [$(TableName)]					
--------------------------------------------------------------------------------------
*/
--:r .\Scripts\Fill.ProjectsConfig.Manpower.sql
--:r .\Scripts\Fill.ProjectsConfig.SO.sql
--:r .\Scripts\Fill.ProjectsConfig.Provident.sql
--:r .\Scripts\Fill.Analyst.ModelElementAttributeTypes.sql
--:r .\Scripts\Fill.Analyst.Objecst.sql

--:r .\Scripts\EnableServiceBroker.sql

--:r .\Scripts\Fill.ProjectsConfig.Test.sql
--:r .\Scripts\Fill.ProjectsConfig.NRWH.sql
TRUNCATE TABLE bidoc.modelelementtypedescriptions


INSERT INTO BIDoc.ModelElementTypeDescriptions(ElementType, TypeDescription)
VALUES
(N'CD.DLS.Model.Mssql.Db.ColumnElement', N'SQL Column'),
(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'SQL Database'),
(N'CD.DLS.Model.Mssql.Db.DeclareVariableElement', N'SQL Variable'),
(N'CD.DLS.Model.Mssql.Db.ForeignKeyElement', N'Foreign Key'),
(N'CD.DLS.Model.Mssql.Db.ProcedureElement', N'Stored Procedure'),
(N'CD.DLS.Model.Mssql.Db.ScalarUdfElement', N'SQL Scalar Function'),
(N'CD.DLS.Model.Mssql.Db.ServerElement', N'SQL Server Instance'),
(N'CD.DLS.Model.Mssql.Db.SchemaElement', N'SQL Schema'),
(N'CD.DLS.Model.Mssql.Db.SchemaTableElement', N'SQL Table'),
(N'CD.DLS.Model.Mssql.Db.SqlDmlSourceElement', N'SQL DML Source'),
(N'CD.DLS.Model.Mssql.Db.SqlDmlTargetReferenceElement', N'SQL DML Target Reference'),
(N'CD.DLS.Model.Mssql.Db.SqlScriptElement', N'SQL Script'),
(N'CD.DLS.Model.Mssql.Db.SqlScriptResultElement', N'SQL Script Result'),
(N'CD.DLS.Model.Mssql.Db.SqlScriptResultColumnElement', N'SQL Script Result Column'),
(N'CD.DLS.Model.Mssql.Db.TableUdfElement', N'SQL Table Function'),
(N'CD.DLS.Model.Mssql.Db.ViewElement', N'SQL View'),
(N'CD.DLS.Model.Mssql.Db.UserDefinedTableTypeElement', N'User-Defined Table Type'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'Framework Project'),
(N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement', N'Calculated Cube Measure'),
(N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement', N'Calculated Report Measure'),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionElement', N'Cube Dimension'),
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', N'SSAS Cube'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'SSAS Database'),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewColumnElement', N'DSV Column'),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewElement', N'Datasource View'),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewTableElement', N'DSV Table'),
(N'CD.DLS.Model.Mssql.Ssas.DegenerateMeasureGroupDimensionElement', N'Degenerate Measure Group Dimension'),
(N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement', N'Dimension Attribute'),
(N'CD.DLS.Model.Mssql.Ssas.DimensionElement', N'SSAS Dimension'),
(N'CD.DLS.Model.Mssql.Ssas.DsvTableBoundPartitionElement', N'DSV Table Partition'),
(N'CD.DLS.Model.Mssql.Ssas.HierarchyElement', N'Dimension Hierarchy'),
(N'CD.DLS.Model.Mssql.Ssas.HierarchyLevelElement', N'Dimension Hierarchy Level'),
(N'CD.DLS.Model.Mssql.Ssas.KeyColumnElement', N'SSAS Dimension Key'),
(N'CD.DLS.Model.Mssql.Ssas.ManyToManyMeasureGroupDimensionElement', N'M:N Measure Group Dimension'),
(N'CD.DLS.Model.Mssql.Ssas.MdxFragmentElement', N'MDX Fragment'),
(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement', N'Calculations (MDX)'),
(N'CD.DLS.Model.Mssql.Ssas.MdxStatementElement', N'MDX Statement'),
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupDimensionColumnBindingElement', N'Measure Group Dimension Binding'),
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement', N'Measure Group'),
(N'CD.DLS.Model.Mssql.Ssas.NameColumnElement', N'Dimension Attribute Name Column'),
(N'CD.DLS.Model.Mssql.Ssas.PartitionColumnElement', N'SSAS Partition Column'),
(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement', N'Cube Measure'),
(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasurePartitionSourceElement', N'SSAS Measure Group Partition Source'),
(N'CD.DLS.Model.Mssql.Ssas.QueryBoundPartitionElement', N'SSAS Query-Bound Partition'),
(N'CD.DLS.Model.Mssql.Ssas.RegularMeasureGroupDimensionElement', N'Regular Measure Group Dimension'),
(N'CD.DLS.Model.Mssql.Ssas.RelatedAttributeElement', N'SSAS Related Attribute'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'SSAS Server Instance'),
(N'CD.DLS.Model.Mssql.Ssis.CatalogElement', N'SSIS Catalog'),
(N'CD.DLS.Model.Mssql.Ssis.ConnectionManagerElement', N'SSIS Connection Manager'),
(N'CD.DLS.Model.Mssql.Ssis.ContainerElement', N'SSIS Container'),
(N'CD.DLS.Model.Mssql.Ssis.DfColumnElement', N'Dataflow Column'),
(N'CD.DLS.Model.Mssql.Ssis.DfComponentElement', N'Dataflow Component'),
(N'CD.DLS.Model.Mssql.Ssis.DfDataConversionElement', N'Data Conversion Component'),
(N'CD.DLS.Model.Mssql.Ssis.DfDestinationElement', N'Dataflow Destination Component'),
(N'CD.DLS.Model.Mssql.Ssis.DfInnerElement', N'SSIS Dataflow Element'),
(N'CD.DLS.Model.Mssql.Ssis.DfInputElement', N'SSIS Dataflow Input'),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupColumnElement', N'SSIS Lookup Column'),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupElement', N'SSIS Lookup'),
(N'CD.DLS.Model.Mssql.Ssis.DfOutputElement', N'SSIS Dataflow Output'),
(N'CD.DLS.Model.Mssql.Ssis.DfPathElement', N'SSIS Dataflow Path'),
(N'CD.DLS.Model.Mssql.Ssis.DfSourceElement', N'SSIS Dataflow Source'),
(N'CD.DLS.Model.Mssql.Ssis.DfTaskElement', N'SSIS Dataflow Task'),
(N'CD.DLS.Model.Mssql.Ssis.ExecutePackageParameterAssignmentElement', N'Execute Package Parameter Assignment'),
(N'CD.DLS.Model.Mssql.Ssis.ExecutePackageTaskElement', N'Execute Package Task'),
(N'CD.DLS.Model.Mssql.Ssis.ExpressionTaskElement', N'Expression Task'),
(N'CD.DLS.Model.Mssql.Ssis.FolderElement', N'SSIS Folder'),
(N'CD.DLS.Model.Mssql.Ssis.PackageElement', N'SSIS Package'),
(N'CD.DLS.Model.Mssql.Ssis.PackageParameterElement', N'SSIS Package Parameter'),
(N'CD.DLS.Model.Mssql.Ssis.PrecedenceConstraintElement', N'Precedence Constraint'),
(N'CD.DLS.Model.Mssql.Ssis.ProjectElement', N'SSIS Project'),
(N'CD.DLS.Model.Mssql.Ssis.ProjectParameterElement', N'Project Parameter'),
(N'CD.DLS.Model.Mssql.Ssis.ServerElement', N'SSIS Server Instance'),
(N'CD.DLS.Model.Mssql.Ssis.SqlTaskElement', N'SSIS SQL Task'),
(N'CD.DLS.Model.Mssql.Ssis.SsisExpressionFragmentElement', N'SSIS Expression Fragment'),
(N'CD.DLS.Model.Mssql.Ssis.SystemVariableElement', N'SSIS System Variable'),
(N'CD.DLS.Model.Mssql.Ssis.TaskElement', N'SSIS Task'),
(N'CD.DLS.Model.Mssql.Ssis.VariableElement', N'SSIS Variable'),
(N'CD.DLS.Model.Mssql.Ssrs.CellElement', N'SSRS Cell'),
(N'CD.DLS.Model.Mssql.Ssrs.DataSetFieldElement', N'SSRS Dataset Field'),
(N'CD.DLS.Model.Mssql.Ssrs.FolderElement', N'SSRS Folder'),
(N'CD.DLS.Model.Mssql.Ssrs.GaugePanelElement', N'SSRS Gauge Panel'),
(N'CD.DLS.Model.Mssql.Ssrs.HierarchyGroupElement', N'SSRS Hierarchy Group'),
(N'CD.DLS.Model.Mssql.Ssrs.HierarchyMemberElement', N'SSRS Hierarchy Member'),
(N'CD.DLS.Model.Mssql.Ssrs.ChartDataElement', N'SSRS Chart Data'),
(N'CD.DLS.Model.Mssql.Ssrs.ChartDataPointElement', N'Chart Data Point'),
(N'CD.DLS.Model.Mssql.Ssrs.ChartElement', N'SSRS Chart'),
(N'CD.DLS.Model.Mssql.Ssrs.ChartSeriesElement', N'Chart Series'),
(N'CD.DLS.Model.Mssql.Ssrs.IndicatorGaugeElement', N'Indicator Gauge'),
(N'CD.DLS.Model.Mssql.Ssrs.ParameterValueElement', N'SSRS Parameter Value'),
(N'CD.DLS.Model.Mssql.Ssrs.QueryParameterElement', N'SSRS Query Parameter'),
(N'CD.DLS.Model.Mssql.Ssrs.RectangleElement', N'SSRS Rectangle'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportDataSetElement', N'Report Dataset'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportDataSourceElement', N'Report Data Source'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportElement', N'SSRS Report'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterDefaultValuesDataSetElement', N'Report Parameter Default Values Dataset'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterDefaultValuesStaticElement', N'Report Parameter Default Values'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterElement', N'Report Parameter'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterValidValuesDataSetElement', N'Report Parameter Valid Values Dataset'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterValidValuesStaticElement', N'Report Parameter Valid Values'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportSectionBodyElement', N'Report Section Body'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportSectionElement', N'Report Section'),
(N'CD.DLS.Model.Mssql.Ssrs.ServerElement', N'SSRS Instance'),
(N'CD.DLS.Model.Mssql.Ssrs.SharedDataSetElement', N'SSRS Shared Dataset'),
(N'CD.DLS.Model.Mssql.Ssrs.SharedDataSourceElement', N'SSRS Shared Dtasource'),
(N'CD.DLS.Model.Mssql.Ssrs.SsrsExpressionElement', N'SSRS Expression'),
(N'CD.DLS.Model.Mssql.Ssrs.SsrsExpressionFragmentElement', N'SSRS Expression Fragment'),
(N'CD.DLS.Model.Mssql.Ssrs.TablixColumnHierarchyElement', N'Tablix Column Hierarchy'),
(N'CD.DLS.Model.Mssql.Ssrs.TablixElement', N'Tablix'),
(N'CD.DLS.Model.Mssql.Ssrs.TablixRowElement', N'Tablix Row'),
(N'CD.DLS.Model.Mssql.Ssrs.TablixRowHierarchyElement', N'Tablix Row Hierarchy'),
(N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement', N'SSRS Textbox'),
(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOutputColumnElement', N'Set Operation Output Column'),
(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOperandColumnElement', N'Set Operation Operand Column'),
(N'CD.DLS.Model.Mssql.Ssis.DbConnectionManagerElement', N'Connection Manager'),
(N'CD.DLS.Model.Mssql.Db.ForeignDbTableElement', N'SQL Table'),
(N'CD.DLS.Model.Mssql.Db.ForeignProviderSqlScriptElement', N'Unknown DB Connection Provider'),
(N'CD.DLS.Model.Mssql.Ssas.ReferencedMeasureGroupDimensionElement', N'Referenced Measure Group Dimension'),
(N'CD.DLS.Model.Mssql.Ssas.TableBoundPartitionElement', N'Table-Bound Partition'),
(N'CD.DLS.Model.Mssql.Ssas.ValueColumnElement', N'SSAS Dimension Value Column'),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupOutputJoinReferenceElement', N'Lookup Column Reference'),
(N'CD.DLS.Model.Mssql.Ssis.DfUnionAllElement', N'Union All Transformation'),
(N'CD.DLS.Model.Mssql.Ssis.DfUnpivotSourceReferenceElement', N'SSIS Unpivot Source Reference Element'),
(N'CD.DLS.Model.Mssql.Ssis.DfMergeJoinElement', N'SSIS Merge Join'),
(N'CD.DLS.Model.Mssql.Ssas.CustomRollupColumnElement', N'Custom Rollup Column'),
(N'CD.DLS.Model.Mssql.Ssas.CustomRollupPropertiesColumnElement', N'Custom Rollup Proprties'),
(N'CD.DLS.Model.Mssql.Ssas.UnaryOperatorColumnElement', N'SSAS Unary Operator'),
(N'CD.DLS.Model.Mssql.Ssis.DfUnpivotElement', N'Unpivot Component'),
(N'CD.DLS.Model.Mssql.Ssis.FileConnectionManagerElement', N'File Connection Manager'),
(N'CD.DLS.Model.Mssql.Ssis.DfDerivedColumnElement', N'Derived Column Information'),
('CD.DLS.Model.Mssql.Ssis.DfColumnAggregationLinkElement', N'SSIS Aggregation Link'),

(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', N'Tabular Database'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDataSourceElement', N'Tabular Database Data Source'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'Tabular Database Table'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement', N'Tabular Database Column'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularAnnotationElement', N'Tabular Database Annotation'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularAttributeHierarchyElement', N'Tabular Attribute Hierarchy'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPartitionElement', N'Tabular Partition'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPartitionColumnElement', N'Tabular Partition Column'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularMeasureElement', N'Tabular Measure'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularHierarchyElement', N'Tabular Hierarchy'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularRelationshipElement', N'Tabular Relationship'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPerspectiveElement', N'Tabular Perspective'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularHierarchyLevelElement', N'Tabular Hierarchy Level'),

(N'CD.DLS.Model.Business.Organization.BusinessFolderElement', N'Folder'),
(N'CD.DLS.Model.Business.Organization.BusinessRootElement', N'Business Objects'),
(N'CD.DLS.Model.Business.Excel.PivotTableTemplateElement', N'Pivot Table Template'),
(N'CD.DLS.Model.Business.Excel.PivotTableFieldElement', N'Pivot Table Field'),
(N'CD.DLS.Model.Business.Excel.PivotTableValuesFilterElement', N'Pivot Table Values Filter'),

(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionAttributeElement', N'Cube Dimension Attribute'),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionHierarchyElement', N'Cube Dimension Hierarchy'),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionHierarchyLevelElement', N'Cube Dimension Hierarchy Level'),

(N'CD.DLS.Model.Mssql.Pbi.TenantElement', N'Tenant'),
(N'CD.DLS.Model.Mssql.Pbi.ReportElement', N'Power BI report'),
(N'CD.DLS.Model.Mssql.Pbi.ReportSectionElement', N'Report page'),
(N'CD.DLS.Model.Mssql.Pbi.VisualElement', N'Power BI report visual'),
(N'CD.DLS.Model.Mssql.Pbi.ProjectionElement', N'Visual field'),
(N'CD.DLS.Model.Mssql.Pbi.ConnectionElement', N'Data Source'),
(N'CD.DLS.Model.Mssql.Pbi.PbiTableElement', N'Query'),
(N'CD.DLS.Model.Mssql.Pbi.PbiColumnElement', N'Query column'),
(N'CD.DLS.Model.Mssql.Pbi.FilterElement', N'Filter'),

-- DAX general start

('CD.DLS.Model.Mssql.Ssas.UnknownDaxTableFunctionElement', N'DAX Table Function'),
('CD.DLS.Model.Mssql.Ssas.GeneralDaxScalarFunctionElement', N'DAX Scalar Function'),
('CD.DLS.Model.Mssql.Ssas.DaxLocalVariableElement', N'DAX Local Variable'),
('CD.DLS.Model.Mssql.Ssas.DaxLocalMeasureElement', N'DAX Local Measure'),
('CD.DLS.Model.Mssql.Ssas.DaxBinaryScalarOperationElement', N'DAX Binary Scalar Operation'),
('CD.DLS.Model.Mssql.Ssas.DaxUnaryScalarOperationElement', N'DAX Unary Scalar Operation'),
('CD.DLS.Model.Mssql.Ssas.DaxTableOperationElement', N'DAX Table Operation'),
('CD.DLS.Model.Mssql.Ssas.DaxTableOperationOutputColumnElement', N'DAX Table Operation Output Column'),
('CD.DLS.Model.Mssql.Ssas.DaxScalarOperationElement', N'DAX Scalar Operation'),
('CD.DLS.Model.Mssql.Ssas.DaxOperationArgumentElement', N'DAX Operation Argument'),
('CD.DLS.Model.Mssql.Ssas.DaxColumnReferenceElement', N'DAX Column Reference'),
('CD.DLS.Model.Mssql.Ssas.DaxTableReferenceElement', N'DAX Table Reference'),
('CD.DLS.Model.Mssql.Ssas.DaxLiteralElement', N'DAX Literal Value'),
('CD.DLS.Model.Mssql.Ssas.DaxDataFlowLinkElement', N'DAX Data Flow Link'),
('CD.DLS.Model.Mssql.Ssas.DaxScriptElement', N'DAX Script'),
('CD.DLS.Model.Mssql.Ssas.DaxFragmentElement', N'DAX Fragment'),

-- DAX general end

-- DAX functions start

('CD.DLS.Model.Mssql.Ssas.DaxCalendarFunctionElement', N'DaxCalendarFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCalendarAutoFunctionElement', N'DaxCalendarAutoFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDateFunctionElement', N'DaxDateFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDateDiffFunctionElement', N'DaxDateDiffFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDateValueFunctionElement', N'DaxDateValueFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDayFunctionElement', N'DaxDayFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxEDateFunctionElement', N'DaxEDateFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxEOMonthFunctionElement', N'DaxEOMonthFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxHourFunctionElement', N'DaxHourFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxMinuteFunctionElement', N'DaxMinuteFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxMonthFunctionElement', N'DaxMonthFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxNowFunctionElement', N'DaxNowFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSecondFunctionElement', N'DaxSecondFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxTimeFunctionElement', N'DaxTimeFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxTimeValueFunctionElement', N'DaxTimeValueFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxTodayFunctionElement', N'DaxTodayFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxUtcNowFunctionElement', N'DaxUtcNowFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxUtcTodayFunctionElement', N'DaxUtcTodayFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxWeekDayFunctionElement', N'DaxWeekDayFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxWeekNumFunctionElement', N'DaxWeekNumFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxYearFunctionElement', N'DaxYearFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxYearFracFunctionElement', N'DaxYearFracFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceMonthFunctionElement', N'DaxClosingBalanceMonthFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceQuarterFunctionElement', N'DaxClosingBalanceQuarterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceYearFunctionElement', N'DaxClosingBalanceYearFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDateAddFunctionElement', N'DaxDateAddFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesBetweenFunctionElement', N'DaxDatesBetweenFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesInPeriodFunctionElement', N'DaxDatesInPeriodFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesMtdFunctionElement', N'DaxDatesMtdFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesQtdFunctionElement', N'DaxDatesQtdFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesYtdFunctionElement', N'DaxDatesYtdFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfMonthFunctionElement', N'DaxEndOfMonthFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfQuarterFunctionElement', N'DaxEndOfQuarterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfYearFunctionElement', N'DaxEndOfYearFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxFirstDateFunctionElement', N'DaxFirstDateFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxFirstNonBlankFunctionElement', N'DaxFirstNonBlankFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxLastDateFunctionElement', N'DaxLastDateFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxLastNonBlankFunctionElement', N'DaxLastNonBlankFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxNextDayFunctionElement', N'DaxNextDayFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxNextMonthFunctionElement', N'DaxNextMonthFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxNextQuarterFunctionElement', N'DaxNextQuarterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxNextYearFunctionElement', N'DaxNextYearFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceMonthFunctionElement', N'DaxOpeningBalanceMonthFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceQuarterFunctionElement', N'DaxOpeningBalanceQuarterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceYearFunctionElement', N'DaxOpeningBalanceYearFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxParallelPeriodFunctionElement', N'DaxParallelPeriodFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousDayFunctionElement', N'DaxPreviousDayFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousMonthFunctionElement', N'DaxPreviousMonthFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousQuarterFunctionElement', N'DaxPreviousQuarterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousYearFunctionElement', N'DaxPreviousYearFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSamePeriodLastYearFunctionElement', N'DaxSamePeriodLastYearFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfMonthFunctionElement', N'DaxStartOfMonthFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfQuarterFunctionElement', N'DaxStartOfQuarterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfYearFunctionElement', N'DaxStartOfYearFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxTotalMtdFunctionElement', N'DaxTotalMtdFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxTotalQtdFunctionElement', N'DaxTotalQtdFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxTotalYtdFunctionElement', N'DaxTotalYtdFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxAddMissingItemsFunctionElement', N'DaxAddMissingItemsFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxAllFunctionElement', N'DaxAllFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxAllExceptFunctionElement', N'DaxAllExceptFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxAllNoBlankRowFunctionElement', N'DaxAllNoBlankRowFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxAllSelectedFunctionElement', N'DaxAllSelectedFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCalculateFunctionElement', N'DaxCalculateFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCalculateTableFunctionElement', N'DaxCalculateTableFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCrossFilterFunctionElement', N'DaxCrossFilterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDistinctFunctionElement', N'DaxDistinctFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxEarlierFunctionElement', N'DaxEarlierFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxEarliestFunctionElement', N'DaxEarliestFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxFilterFunctionElement', N'DaxFilterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxFiltersFunctionElement', N'DaxFiltersFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxHasOneFilterFunctionElement', N'DaxHasOneFilterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxHasOneValueFunctionElement', N'DaxHasOneValueFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsCrossFilteredFunctionElement', N'DaxIsCrossFilteredFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsFilteredFunctionElement', N'DaxIsFilteredFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxKeepFiltersFunctionElement', N'DaxKeepFiltersFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxRelatedFunctionElement', N'DaxRelatedFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxRelatedTableFunctionElement', N'DaxRelatedTableFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSelectedValueFunctionElement', N'DaxSelectedValueFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSubstituteWithIndexFunctionElement', N'DaxSubstituteWithIndexFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxUseRelationshipFunctionElement', N'DaxUseRelationshipFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxValuesFunctionElement', N'DaxValuesFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxContainsFunctionElement', N'DaxContainsFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCustomDataFunctionElement', N'DaxCustomDataFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsBlankFunctionElement', N'DaxIsBlankFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsErrorFunctionElement', N'DaxIsErrorFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsEvenFunctionElement', N'DaxIsEvenFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsInScopeFunctionElement', N'DaxIsInScopeFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsLogicalFunctionElement', N'DaxIsLogicalFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsNonTextFunctionElement', N'DaxIsNonTextFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsNumberFunctionElement', N'DaxIsNumberFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsOddFunctionElement', N'DaxIsOddFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsOnOrAfterFunctionElement', N'DaxIsOnOrAfterFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsTextFunctionElement', N'DaxIsTextFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxLookupValueFunctionElement', N'DaxLookupValueFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxUserNameFunctionElement', N'DaxUserNameFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxAndFunctionElement', N'DaxAndFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxFalseFunctionElement', N'DaxFalseFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIfFunctionElement', N'DaxIfFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIfErrorFunctionElement', N'DaxIfErrorFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxNotFunctionElement', N'DaxNotFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxOrFunctionElement', N'DaxOrFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSwitchFunctionElement', N'DaxSwitchFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxTrueFunctionElement', N'DaxTrueFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDataTableFunctionElement', N'DaxDataTableFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxErrorFunctionElement', N'DaxErrorFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxExceptFunctionElement', N'DaxExceptFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateSeriesFunctionElement', N'DaxGenerateSeriesFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxGroupByFunctionElement', N'DaxGroupByFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIntersectFunctionElement', N'DaxIntersectFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxIsEmptyFunctionElement', N'DaxIsEmptyFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxNaturalInnerJoinFunctionElement', N'DaxNaturalInnerJoinFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxNaturalLeftOuterJoinFunctionElement', N'DaxNaturalLeftOuterJoinFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSummarizeColumnsFunctionElement', N'DaxSummarizeColumnsFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxTreatAsFunctionElement', N'DaxTreatAsFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxUnionFunctionElement', N'DaxUnionFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxAddColumnsFunctionElement', N'DaxAddColumnsFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCrossJoinFunctionElement', N'DaxCrossJoinFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateFunctionElement', N'DaxGenerateFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateAllFunctionElement', N'DaxGenerateAllFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxRowFunctionElement', N'DaxRowFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSampleFunctionElement', N'DaxSampleFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSelectColumnsFunctionElement', N'DaxSelectColumnsFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSummarizeFunctionElement', N'DaxSummarizeFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCountRowsFunctionElement', N'DaxCountRowsFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCountFunctionElement', N'DaxCountFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxCountaFunctionElement', N'DaxCountaFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxDistinctCountFunctionElement', N'DaxDistinctCountFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxSumFunctionElement', N'DaxSumFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxBlankFunctionElement', N'DaxBlankFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxFormatFunctionElement', N'DaxFormatFunction'),
('CD.DLS.Model.Mssql.Ssas.DaxRightFunctionElement', N'DaxRightFunction')

-- DAX functions end
TRUNCATE TABLE bidoc.modelelementtypedetaillevels


INSERT INTO BIDoc.ModelElementTypeDetailLevels(ElementType, DetailLevel)
VALUES
(N'CD.DLS.Model.Mssql.Ssis.ExecutePackageTaskElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterDefaultValuesDataSetElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.ContainerElement', 1),
(N'CD.DLS.Model.Mssql.Db.DeclareVariableElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.HierarchyMemberElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfInnerElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewColumnElement', 1),
(N'CD.DLS.Model.Mssql.Db.DatabaseElement', 3),
(N'CD.DLS.Model.Mssql.Ssrs.TablixRowHierarchyElement', 1),
(N'CD.DLS.Model.Mssql.Db.ScalarUdfElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.ConnectionManagerElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.CatalogElement', 3),
(N'CD.DLS.Model.Mssql.Db.ViewElement', 2),
(N'CD.DLS.Model.Mssql.Ssrs.ChartSeriesElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.TableBoundPartitionElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterValidValuesStaticElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.RegularMeasureGroupDimensionElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ChartDataPointElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.SsisExpressionFragmentElement', 1),
(N'CD.DLS.Model.Mssql.Db.ColumnElement', 1),
(N'CD.DLS.Model.Mssql.SolutionModelElement', 3),
(N'CD.DLS.Model.Mssql.Ssas.DsvTableBoundPartitionElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.MdxFragmentElement', 1),
(N'CD.DLS.Model.Mssql.Db.ForeignProviderSqlScriptElement', 1),
(N'CD.DLS.Model.Mssql.Db.SqlScriptResultElement', 1),
(N'CD.DLS.Model.Mssql.Db.SqlScriptResultColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfComponentElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.VariableElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.QueryParameterElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ServerElement', 3),
(N'CD.DLS.Model.Mssql.Ssrs.GaugePanelElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.SsrsExpressionElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfInputElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportDataSourceElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.QueryBoundPartitionElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ParameterValueElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.FolderElement', 3),
(N'CD.DLS.Model.Mssql.Ssas.MdxStatementElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.CellElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.ProjectElement', 3),
(N'CD.DLS.Model.Mssql.Ssrs.ReportSectionBodyElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewTableElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.DfSourceElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.TablixRowElement', 1),
(N'CD.DLS.Model.Mssql.Db.SqlDmlSourceElement', 1),
(N'CD.DLS.Model.Mssql.Db.SqlScriptElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.FolderElement', 3),
(N'CD.DLS.Model.Mssql.Db.SchemaTableElement', 2),
(N'CD.DLS.Model.Mssql.Ssrs.HierarchyGroupElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionElement', 2),
(N'CD.DLS.Model.Mssql.Ssas.NameColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.TablixColumnHierarchyElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.TaskElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasurePartitionSourceElement', 1),
(N'CD.DLS.Model.Mssql.Db.SqlDmlTargetReferenceElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.RectangleElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement', 2),
(N'CD.DLS.Model.Mssql.Ssrs.DataSetFieldElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.PartitionColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.HierarchyLevelElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.ExpressionTaskElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportDataSetElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupDimensionColumnBindingElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ChartDataElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfDestinationElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', 3),
(N'CD.DLS.Model.Mssql.Ssas.RelatedAttributeElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfUnionAllElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.ValueColumnElement', 1),
(N'CD.DLS.Model.Mssql.Db.ForeignKeyElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.PackageParameterElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.DimensionElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.DfOutputElement', 1),
(N'CD.DLS.Model.Mssql.Db.ForeignDbTableElement', 2),
(N'CD.DLS.Model.Mssql.Ssrs.ChartElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupOutputJoinReferenceElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.PrecedenceConstraintElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.KeyColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.IndicatorGaugeElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', 3),
(N'CD.DLS.Model.Mssql.Ssis.ExecutePackageParameterAssignmentElement', 1),
(N'CD.DLS.Model.Mssql.Db.SchemaElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.DfTaskElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement', 2),
(N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement', 1),
(N'CD.DLS.Model.Mssql.Db.ProcedureElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.PackageElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.DbConnectionManagerElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.SsrsExpressionFragmentElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.ProjectParameterElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfDataConversionElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.SharedDataSourceElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.SystemVariableElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterDefaultValuesStaticElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.SqlTaskElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.ServerElement', 3),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', 3),
(N'CD.DLS.Model.Mssql.Ssas.HierarchyElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterValidValuesDataSetElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.TablixElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.ManyToManyMeasureGroupDimensionElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.DfPathElement', 1),
(N'CD.DLS.Model.Mssql.Ssrs.ReportSectionElement', 1),
(N'CD.DLS.Model.Mssql.Db.ServerElement', 3),
(N'CD.DLS.Model.Mssql.Ssas.DegenerateMeasureGroupDimensionElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.ReferencedMeasureGroupDimensionElement', 1),
(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOutputColumnElement', 1),
(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOperandColumnElement', 1),
(N'CD.DLS.Model.Mssql.Db.TableUdfElement', 2),
(N'CD.DLS.Model.Mssql.Db.UserDefinedTableTypeElement', 2),
(N'CD.DLS.Model.Mssql.Ssrs.SharedDataSetElement', 2),
(N'CD.DLS.Model.Mssql.Ssis.DfUnpivotSourceReferenceElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfMergeJoinElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.CustomRollupColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.CustomRollupPropertiesColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.UnaryOperatorColumnElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfUnpivotElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.FileConnectionManagerElement', 1),
(N'CD.DLS.Model.Mssql.Ssis.DfDerivedColumnElement', 1),
('CD.DLS.Model.Mssql.Ssis.DfColumnAggregationLinkElement', 1),

(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', 3),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDataSourceElement', 2),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', 2),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularAnnotationElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularAttributeHierarchyElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPartitionElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPartitionColumnElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularMeasureElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularHierarchyElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularRelationshipElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPerspectiveElement', 1),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularHierarchyLevelElement',1),

(N'CD.DLS.Model.Business.Organization.BusinessFolderElement', 3),
(N'CD.DLS.Model.Business.Organization.BusinessRootElement', 3),
(N'CD.DLS.Model.Business.Excel.PivotTableTemplateElement', 2),
(N'CD.DLS.Model.Business.Excel.PivotTableFieldElement', 1),
(N'CD.DLS.Model.Business.Excel.PivotTableValuesFilterElement', 1),

(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionAttributeElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionHierarchyElement', 1),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionHierarchyLevelElement', 1),

(N'CD.DLS.Model.Mssql.Pbi.TenantElement', 3),
(N'CD.DLS.Model.Mssql.Pbi.ReportElement', 2),
(N'CD.DLS.Model.Mssql.Pbi.ReportSectionElement',2),
(N'CD.DLS.Model.Mssql.Pbi.VisualElement', 2),
(N'CD.DLS.Model.Mssql.Pbi.ProjectionElement', 1),
(N'CD.DLS.Model.Mssql.Pbi.ConnectionElement', 1),
(N'CD.DLS.Model.Mssql.Pbi.PbiTableElement', 2),
(N'CD.DLS.Model.Mssql.Pbi.PbiColumnElement', 1),
(N'CD.DLS.Model.Mssql.Pbi.FilterElement', 1),


-- DAX general start

('CD.DLS.Model.Mssql.Ssas.UnknownDaxTableFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.GeneralDaxScalarFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxLocalVariableElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxLocalMeasureElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxBinaryScalarOperationElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxUnaryScalarOperationElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTableOperationElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTableOperationOutputColumnElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxScalarOperationElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxOperationArgumentElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxColumnReferenceElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTableReferenceElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxLiteralElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDataFlowLinkElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxScriptElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxFragmentElement', 1),

-- DAX general end

-- DAX functions start

('CD.DLS.Model.Mssql.Ssas.DaxCalendarFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCalendarAutoFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDateFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDateDiffFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDateValueFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDayFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxEDateFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxEOMonthFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxHourFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxMinuteFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxMonthFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxNowFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSecondFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTimeFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTimeValueFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTodayFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxUtcNowFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxUtcTodayFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxWeekDayFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxWeekNumFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxYearFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxYearFracFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceMonthFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceQuarterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceYearFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDateAddFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDatesBetweenFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDatesInPeriodFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDatesMtdFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDatesQtdFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDatesYtdFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfMonthFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfQuarterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfYearFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxFirstDateFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxFirstNonBlankFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxLastDateFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxLastNonBlankFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxNextDayFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxNextMonthFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxNextQuarterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxNextYearFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceMonthFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceQuarterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceYearFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxParallelPeriodFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousDayFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousMonthFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousQuarterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousYearFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSamePeriodLastYearFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfMonthFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfQuarterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfYearFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTotalMtdFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTotalQtdFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTotalYtdFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxAddMissingItemsFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxAllFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxAllExceptFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxAllNoBlankRowFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxAllSelectedFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCalculateFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCalculateTableFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCrossFilterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDistinctFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxEarlierFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxEarliestFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxFilterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxFiltersFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxHasOneFilterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxHasOneValueFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsCrossFilteredFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsFilteredFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxKeepFiltersFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxRelatedFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxRelatedTableFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSelectedValueFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSubstituteWithIndexFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxUseRelationshipFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxValuesFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxContainsFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCustomDataFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsBlankFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsErrorFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsEvenFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsInScopeFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsLogicalFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsNonTextFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsNumberFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsOddFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsOnOrAfterFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsTextFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxLookupValueFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxUserNameFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxAndFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxFalseFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIfFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIfErrorFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxNotFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxOrFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSwitchFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTrueFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDataTableFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxErrorFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxExceptFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateSeriesFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxGroupByFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIntersectFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxIsEmptyFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxNaturalInnerJoinFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxNaturalLeftOuterJoinFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSummarizeColumnsFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxTreatAsFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxUnionFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxAddColumnsFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCrossJoinFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateAllFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxRowFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSampleFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSelectColumnsFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSummarizeFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCountRowsFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCountFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxCountaFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxDistinctCountFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxSumFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxBlankFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxFormatFunctionElement', 1),
('CD.DLS.Model.Mssql.Ssas.DaxRightFunctionElement', 1)

-- DAX functions end





TRUNCATE TABLE bidoc.modelelementtypeclasses


INSERT INTO BIDoc.ModelElementTypeClasses(ElementType, ClassCode)
VALUES
(N'CD.DLS.Model.Mssql.Ssis.ExecutePackageTaskElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterDefaultValuesDataSetElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.ContainerElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.DeclareVariableElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.HierarchyMemberElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfInnerElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.TablixRowHierarchyElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.ScalarUdfElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.ConnectionManagerElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.CatalogElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.ViewElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.ChartSeriesElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.TableBoundPartitionElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterValidValuesStaticElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.RegularMeasureGroupDimensionElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.ChartDataPointElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.SsisExpressionFragmentElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.ColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.DsvTableBoundPartitionElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.MdxFragmentElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.ForeignProviderSqlScriptElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.DfComponentElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.VariableElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.QueryParameterElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ServerElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.GaugePanelElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.SsrsExpressionElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.DfInputElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportDataSourceElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.QueryBoundPartitionElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.ParameterValueElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.FolderElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.MdxStatementElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.CellElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.ProjectElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportSectionBodyElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewTableElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfSourceElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.TablixRowElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.SqlDmlSourceElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.SqlScriptElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.SqlScriptResultElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.SqlScriptResultColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.FolderElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.SchemaTableElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.HierarchyGroupElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.NameColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.TablixColumnHierarchyElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.TaskElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasurePartitionSourceElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.SqlDmlTargetReferenceElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.RectangleElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.DataSetFieldElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.PartitionColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.HierarchyLevelElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.ExpressionTaskElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportDataSetElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupDimensionColumnBindingElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ChartDataElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfDestinationElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.RelatedAttributeElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfUnionAllElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.ValueColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.ForeignKeyElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupColumnElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.PackageParameterElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.DimensionElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfOutputElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.ForeignDbTableElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.ChartElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupOutputJoinReferenceElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.PrecedenceConstraintElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.KeyColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.IndicatorGaugeElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.ExecutePackageParameterAssignmentElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.SchemaElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfTaskElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.ProcedureElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.PackageElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.DbConnectionManagerElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.DfLookupElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.SsrsExpressionFragmentElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.DfColumnElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.ProjectParameterElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfDataConversionElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.SharedDataSourceElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.SystemVariableElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterDefaultValuesStaticElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.SqlTaskElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.ServerElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.HierarchyElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterValidValuesDataSetElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.TablixElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.ManyToManyMeasureGroupDimensionElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfPathElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportSectionElement', N'F'),
(N'CD.DLS.Model.Mssql.Db.ServerElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.DegenerateMeasureGroupDimensionElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.ReferencedMeasureGroupDimensionElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOutputColumnElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOperandColumnElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.TableUdfElement', N'T'),
(N'CD.DLS.Model.Mssql.Db.UserDefinedTableTypeElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssrs.SharedDataSetElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfUnpivotSourceReferenceElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.DfMergeJoinElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssas.CustomRollupColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.CustomRollupPropertiesColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.UnaryOperatorColumnElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.DfUnpivotElement', N'T'),
(N'CD.DLS.Model.Mssql.Ssis.FileConnectionManagerElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssis.DfDerivedColumnElement', N'T'),
('CD.DLS.Model.Mssql.Ssis.DfColumnAggregationLinkElement', N'T'),

/*
(N'CD.DLS.Model.Mssql.Tabular.TabularModelElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedTabularDatabase', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedTabularModel', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedTabularDataSource', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedTabularTable', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedTabularTableColumn', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedTabularAnnotation', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedAttributeHierarchy', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedPartition', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedMeasure', N'T'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedHierarchy', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedRelationship', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedPerspective', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.ParsedHierarchyLevel', N'F'),
*/

(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDataSourceElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularAnnotationElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularAttributeHierarchyElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPartitionElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPartitionColumnElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularMeasureElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularHierarchyElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularRelationshipElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularPerspectiveElement', N'F'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularHierarchyLevelElement', N'F'),

(N'CD.DLS.Model.Business.Organization.BusinessFolderElement', N'F'),
(N'CD.DLS.Model.Business.Organization.BusinessRootElement', N'F'),
(N'CD.DLS.Model.Business.Excel.PivotTableTemplateElement', N'F'),
(N'CD.DLS.Model.Business.Excel.PivotTableFieldElement', N'F'),
(N'CD.DLS.Model.Business.Excel.PivotTableValuesFilterElement', N'F'),

(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionAttributeElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionHierarchyElement', N'F'),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionHierarchyLevelElement', N'F'),

(N'CD.DLS.Model.Mssql.Pbi.TenantElement', N'F'),
(N'CD.DLS.Model.Mssql.Pbi.ReportSectionElement', N'F'),
(N'CD.DLS.Model.Mssql.Pbi.ReportElement', N'F'),


-- DAX general start

('CD.DLS.Model.Mssql.Ssas.UnknownDaxTableFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.GeneralDaxScalarFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxLocalVariableElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxLocalMeasureElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxBinaryScalarOperationElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxUnaryScalarOperationElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTableOperationElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTableOperationOutputColumnElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxScalarOperationElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxOperationArgumentElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxColumnReferenceElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTableReferenceElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxLiteralElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDataFlowLinkElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxScriptElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxFragmentElement', N'T'),

-- DAX general end

-- DAX functions start

('CD.DLS.Model.Mssql.Ssas.DaxCalendarFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCalendarAutoFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDateFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDateDiffFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDateValueFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDayFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxEDateFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxEOMonthFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxHourFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxMinuteFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxMonthFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxNowFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSecondFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTimeFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTimeValueFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTodayFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxUtcNowFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxUtcTodayFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxWeekDayFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxWeekNumFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxYearFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxYearFracFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceMonthFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceQuarterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxClosingBalanceYearFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDateAddFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesBetweenFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesInPeriodFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesMtdFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesQtdFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDatesYtdFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfMonthFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfQuarterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxEndOfYearFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxFirstDateFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxFirstNonBlankFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxLastDateFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxLastNonBlankFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxNextDayFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxNextMonthFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxNextQuarterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxNextYearFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceMonthFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceQuarterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxOpeningBalanceYearFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxParallelPeriodFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousDayFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousMonthFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousQuarterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxPreviousYearFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSamePeriodLastYearFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfMonthFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfQuarterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxStartOfYearFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTotalMtdFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTotalQtdFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTotalYtdFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxAddMissingItemsFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxAllFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxAllExceptFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxAllNoBlankRowFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxAllSelectedFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCalculateFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCalculateTableFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCrossFilterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDistinctFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxEarlierFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxEarliestFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxFilterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxFiltersFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxHasOneFilterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxHasOneValueFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsCrossFilteredFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsFilteredFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxKeepFiltersFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxRelatedFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxRelatedTableFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSelectedValueFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSubstituteWithIndexFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxUseRelationshipFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxValuesFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxContainsFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCustomDataFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsBlankFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsErrorFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsEvenFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsInScopeFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsLogicalFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsNonTextFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsNumberFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsOddFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsOnOrAfterFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsTextFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxLookupValueFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxUserNameFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxAndFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxFalseFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIfFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIfErrorFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxNotFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxOrFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSwitchFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTrueFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDataTableFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxErrorFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxExceptFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateSeriesFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxGroupByFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIntersectFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxIsEmptyFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxNaturalInnerJoinFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxNaturalLeftOuterJoinFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSummarizeColumnsFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxTreatAsFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxUnionFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxAddColumnsFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCrossJoinFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxGenerateAllFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxRowFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSampleFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSelectColumnsFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSummarizeFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCountRowsFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCountFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxCountaFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxDistinctCountFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxSumFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxBlankFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxFormatFunctionElement', N'T'),
('CD.DLS.Model.Mssql.Ssas.DaxRightFunctionElement', N'T')

-- DAX functions end


GO

DECLARE @receiverId UNIQUEIDENTIFIER = N'287E123F-6DC6-4EAB-8F95-14E42B25F1D6'

IF NOT EXISTS(SELECT 1 FROM adm.GlobalConfig WHERE [Key] = N'SVC_RUNCONSOLE')
BEGIN
	INSERT INTO adm.GlobalConfig([Key], [Value])
	VALUES(N'SVC_RUNCONSOLE', N'False')
END

IF NOT EXISTS(SELECT 1 FROM adm.GlobalConfig WHERE [Key] = N'SVC_INSTANCE_ID')
BEGIN
	INSERT INTO adm.GlobalConfig([Key], [Value])
	VALUES(N'SVC_INSTANCE_ID', @receiverId)
END

GO
DELETE [BIDoc].[SourceDataTypes]
DELETE [BIDoc].[DataTypes]

INSERT INTO BIDoc.DataTypes
(
	[DataTypeName]
)
VALUES (N'String'),
(N'Integer'),
(N'Boolean'),
(N'Character'),
(N'Date'),
(N'Floating-point number'),
(N'Fixed-point number'),
(N'Unknown'),
(N'Image'),
(N'Binary'),
(N'Text');

INSERT INTO [BIDoc].[SourceDataTypes]
(
	[SourceName],
	[SourceDataTypeName],
	[DataTypeId]
)
VALUES ('MS SQL', 'None', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Unknown')),
('MS SQL', 'BigInt', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('MS SQL', 'Binary', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Binary')),
('MS SQL', 'Bit', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('MS SQL', 'Char', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Character')),
('MS SQL', 'DateTime', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('MS SQL', 'Decimal', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Fixed-point number')),
('MS SQL', 'Float', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Floating-point number')),
('MS SQL', 'Image', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Image')),
('MS SQL', 'Int', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('MS SQL', 'Money', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Fixed-point number')),
('MS SQL', 'Nchar', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Character')),
('MS SQL', 'Ntext', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'String')),
('MS SQL', 'NVarChar', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Character')),
('MS SQL', 'NVarCharMax', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Text')),
('MS SQL', 'Real', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Floating-point number')),
('MS SQL', 'SmallDateTime', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('MS SQL', 'SmallInt', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('MS SQL', 'SmallMoney', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Fixed-point number')),
('MS SQL', 'Text', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Text')),
('MS SQL', 'Timestamp', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('MS SQL', 'TinyInt', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('MS SQL', 'UniqueIdentifier', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('MS SQL', 'UserDefinedDataType', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Unknown')),
('MS SQL', 'UserDefinedType', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Unknown')),
('MS SQL', 'VarBinary', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Binary')),
('MS SQL', 'VarBinaryMax', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Binary')),
('MS SQL', 'VarChar', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'String')),
('MS SQL', 'VarCharMax', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Text')),
('MS SQL', 'Variant', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Unknown')),
('MS SQL', 'Xml', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Unknown')),
('MS SQL', 'SysName', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'String')),
('MS SQL', 'Numeric', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Fixed-point number')),
('MS SQL', 'Date', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('MS SQL', 'Time', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('MS SQL', 'DateTimeOffset', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('MS SQL', 'DateTime2 ', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('MS SQL', 'UserDefinedTableType', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Unknown')),
('MS SQL', 'HierarchyId', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('MS SQL', 'Geometry', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Unknown')),
('MS SQL', 'Geography', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Unknown')),
('SSIS', 'DT_BOOL', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Boolean')),
('SSIS', 'DT_BYTES', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Binary')),
('SSIS', 'DT_CY', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_DATE', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('SSIS', 'DT_DBDATE', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('SSIS', 'DT_DBTIME', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('SSIS', 'DT_DBTIME2', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('SSIS', 'DT_DBTIMESTAMP', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('SSIS', 'DT_DBTIMESTAMP2', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('SSIS', 'DT_DBTIMESTAMPOFFSET', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('SSIS', 'DT_DECIMAL', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Fixed-point number')),
('SSIS', 'DT_FILETIME', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Date')),
('SSIS', 'DT_GUID', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_I1', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_I2', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_I4', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_I8', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_NUMERIC', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Fixed-point number')),
('SSIS', 'DT_R4', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Floating-point number')),
('SSIS', 'DT_R8', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Floating-point number')),
('SSIS', 'DT_STR', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'String')),
('SSIS', 'DT_UI1', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_UI2', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_UI4', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_UI8', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Integer')),
('SSIS', 'DT_WSTR', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'String')),
('SSIS', 'DT_IMAGE', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Image')),
('SSIS', 'DT_NTEXT', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Text')),
('SSIS', 'DT_TEXT', (SELECT DataTypesId FROM [BIDoc].[DataTypes] WHERE DataTypeName = 'Text'));
GO
CREATE TABLE #DataMessageData
(
[Message] NVARCHAR(30),
[Code] NVARCHAR(10)
)
INSERT INTO #DataMessageData
(
	[Message],
	[Code]
)
VALUES ('Truncation may occur', 'Truncat');

MERGE BIDoc.DataMessagesType  AS t 
USING #DataMessageData AS s
ON t.[DataMessageType] = s.[Message] AND t.[DataMessageCode] = s.[Code]
WHEN NOT MATCHED THEN INSERT([DataMessageType],[DataMessageCode])
VALUES(
[Message],
[Code]
)
WHEN MATCHED THEN UPDATE SET t.[DataMessageType] = s.[Message], t.[DataMessageCode] = s.[Code];
TRUNCATE TABLE [Search].[TypeChildTypes]
GO

INSERT INTO [Search].[TypeChildTypes]
([ParentType], [ChildType])
SELECT map.ParentType, map.ChildType
FROM   (VALUES
	(NULL, N'CD.DLS.Model.Mssql.Ssrs.ReportElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssis.PackageElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssis.ProjectElement'),
	(NULL, N'CD.DLS.Model.Mssql.Db.ViewElement'),
	(NULL, N'CD.DLS.Model.Mssql.Db.SchemaTableElement'),
	(NULL, N'CD.DLS.Model.Mssql.Db.ProcedureElement'),
	(NULL, N'CD.DLS.Model.Mssql.Db.ColumnElement'),
	(NULL, N'CD.DLS.Model.Mssql.Db.DatabaseElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement'),
	--(NULL, N'CD.DLS.Model.Mssql.Ssas.CalculatedMeasureElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssas.DimensionElement'),
	(NULL, N'CD.DLS.Model.Mssql.Ssas.CubeElement'),
	(NULL, N'CD.DLS.Model.Business.Excel.PivotTableTemplateElement'),

	(N'CD.DLS.Model.Mssql.Pbi.TenantElement', N'CD.DLS.Model.Mssql.Pbi.ReportElement'),
	(N'CD.DLS.Model.Mssql.Pbi.TenantElement', N'CD.DLS.Model.Mssql.Pbi.ReportSectionElement'),
	(N'CD.DLS.Model.Mssql.Pbi.TenantElement', N'CD.DLS.Model.Mssql.Pbi.VisualElement'),
	
	(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.ColumnElement'),
	(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.SchemaTableElement'),
	(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.ProcedureElement'),
	(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.ViewElement'),
	(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.DatabaseElement'),
	
	(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.CalculatedMeasureElement'),
	(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement'),
	(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement'),
	(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement'),
	(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.DimensionElement'),
	(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.CubeElement'),

	(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularMeasureElement'),
	(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement'),
	(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement'),
	
	(N'CD.DLS.Model.Mssql.Ssis.ProjectElement', N'CD.DLS.Model.Mssql.Ssis.PackageElement'),
	(N'CD.DLS.Model.Mssql.Ssis.ProjectElement', N'CD.DLS.Model.Mssql.Ssis.ProjectElement'),
	
	(N'CD.DLS.Model.Mssql.Ssrs.FolderElement', N'CD.DLS.Model.Mssql.Ssrs.ReportElement'),
	(N'CD.DLS.Model.Mssql.Ssrs.FolderElement', N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement'),

	(N'CD.DLS.Model.Business.Organization.BusinessRootElement', N'CD.DLS.Model.Business.Excel.PivotTableTemplateElement')
	) map(ParentType, ChildType)
LEFT JOIN [Search].[TypeChildTypes] ex ON ISNULL(ex.ParentType, N'') = ISNULL(map.ParentType, N'') AND ex.ChildType = map.ChildType
WHERE ex.ChildType IS NULL
TRUNCATE TABLE Search.BusinessDictionarySupportedTypes

INSERT INTO Search.BusinessDictionarySupportedTypes
VALUES 
	(N'CD.DLS.Model.Mssql.Ssrs.ReportElement'),	
	(N'CD.DLS.Model.Mssql.Ssis.PackageElement'),
	(N'CD.DLS.Model.Mssql.Ssas.CubeElement'),
	(N'CD.DLS.Model.Mssql.Db.DatabaseElement'),
	(N'CD.DLS.Model.Mssql.Ssis.ProjectElement'),
	(N'CD.DLS.Model.Mssql.Ssas.DimensionElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement'),
	(N'CD.DLS.Model.Mssql.Db.ViewElement'),
	(N'CD.DLS.Model.Mssql.Db.SchemaTableElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement'),
	(N'CD.DLS.Model.Mssql.Db.ProcedureElement'),
	(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement'),
	(N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement'),
	(N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement'),
	(N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement'),
	(N'CD.DLS.Model.Mssql.Db.ColumnElement')

--:r .\Scripts\Fill.CreateDataFlowSequences.sql

INSERT INTO [Adm].[Roles]
([RoleName])
SELECT roles.RoleName
FROM   (VALUES
	--(N'ProjectCreator'),	-- system
	(N'CustomerUser'),	-- system; the role gained by assignment to AAD group corresponding to the customer
	--(N'ProjectAdmin'),	-- project
	(N'CustomerAdmin')		-- system
	) roles(RoleName)
LEFT JOIN [Adm].[Roles] ex ON ex.RoleName = roles.RoleName
WHERE ex.RoleId IS NULL


INSERT INTO [Adm].[Permissions]
([PermissionName])
SELECT perms.PermissionName
FROM   (VALUES
	--(N'CreateProject'),
	(N'ManageProject'),
	(N'ViewLineage'),
	(N'UpdateLineage'),
	(N'ViewAnnotations'),
	(N'EditAnnotations'),
	(N'EditPermissions')
	) perms(PermissionName)
LEFT JOIN [Adm].[Permissions] ex ON ex.PermissionName = perms.PermissionName
WHERE ex.PermissionId IS NULL

INSERT INTO [Adm].[RolePermissions]([RoleId], [PermissionId])
SELECT r.RoleId, p.PermissionId FROM
(VALUES
	(N'CustomerUser', N'ViewLineage'),
	(N'CustomerUser', N'ViewAnnotations'),
	(N'CustomerUser', N'EditAnnotations'),

	--(N'CustomerAdmin', N'CreateProject'),
	(N'CustomerAdmin', N'ManageProject'),
	(N'CustomerAdmin', N'ViewLineage'),
	(N'CustomerAdmin', N'UpdateLineage'),
	(N'CustomerAdmin', N'ViewAnnotations'),
	(N'CustomerAdmin', N'EditAnnotations'),
	(N'CustomerAdmin', N'EditPermissions')
	--,
	--(N'ProjectAdmin', N'ManageProject'),
	--(N'ProjectAdmin', N'ViewLineage'),
	--(N'ProjectAdmin', N'UpdateLineage'),
	--(N'ProjectAdmin', N'ViewAnnotations'),
	--(N'ProjectAdmin', N'EditAnnotations')
	) perms(RoleName, PermissionName)
INNER JOIN adm.Roles r ON r.RoleName = perms.RoleName
INNER JOIN adm.Permissions p ON p.PermissionName = perms.PermissionName
LEFT JOIN adm.RolePermissions rp ON rp.PermissionId = p.PermissionId AND rp.RoleId = r.RoleId
WHERE r.ProjectConfigId IS NULL AND rp.RolePermissionId IS NULL

TRUNCATE TABLE [BIDoc].[HighLevelTypeDescendants]

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssrs.ReportElement',N'ReportElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement',N'TextBoxElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssis.PackageElement',N'PackageElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssas.CubeElement',N'CubeElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssas.DimensionElement',N'DimensionElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement',N'DimensionAttributeElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement',N'MdxScriptElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Db.DatabaseElement',N'DatabaseElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Db.ViewElement',N'ViewElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Db.SchemaTableElement',N'SchemaTableElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Db.ColumnElement',N'ColumnElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement',N'MeasureGroupElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement',N'PhysicalMeasureElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement',N'CubeCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement',N'ReportCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.SolutionModelElement', N'CD.DLS.Model.Mssql.Pbi.TenantElement',N'TenantElement')



INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Db.ServerElement', N'CD.DLS.Model.Mssql.Db.DatabaseElement',N'DatabaseElement'),
(N'CD.DLS.Model.Mssql.Db.ServerElement', N'CD.DLS.Model.Mssql.Db.ViewElement',N'ViewElement'),
(N'CD.DLS.Model.Mssql.Db.ServerElement', N'CD.DLS.Model.Mssql.Db.SchemaTableElement',N'SchemaTableElement'),
(N'CD.DLS.Model.Mssql.Db.ServerElement', N'CD.DLS.Model.Mssql.Db.ColumnElement',N'ColumnElement')



INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssis.ServerElement', N'CD.DLS.Model.Mssql.Ssis.PackageElement',N'PackageElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Ssas.CubeElement',N'CubeElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Ssas.DimensionElement',N'DimensionElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement',N'DimensionAttributeElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement',N'MdxScriptElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement',N'MeasureGroupElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement',N'PhysicalMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement',N'CubeCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement',N'ReportCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement', N'SsasTabularTableColumnElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'SsasTabularTableElement'),
(N'CD.DLS.Model.Mssql.Ssas.ServerElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularMeasureElement', N'SsasTabularMeasureElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssrs.ServerElement', N'CD.DLS.Model.Mssql.Ssrs.ReportElement',N'ReportElement'),
(N'CD.DLS.Model.Mssql.Ssrs.ServerElement', N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement',N'TextBoxElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.DatabaseElement',N'DatabaseElement'),
(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.ViewElement',N'ViewElement'),
(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.SchemaTableElement',N'SchemaTableElement'),
(N'CD.DLS.Model.Mssql.Db.DatabaseElement', N'CD.DLS.Model.Mssql.Db.ColumnElement',N'ColumnElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.CubeElement',N'CubeElement'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.DimensionElement',N'DimensionElement'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement',N'DimensionAttributeElement'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement',N'MdxScriptElement'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement',N'MeasureGroupElement'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement',N'PhysicalMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement',N'CubeCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.SsasMultidimensionalDatabaseElement', N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement',N'ReportCalculatedMeasureElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssrs.FolderElement', N'CD.DLS.Model.Mssql.Ssrs.ReportElement',N'ReportElement'),
(N'CD.DLS.Model.Mssql.Ssrs.FolderElement', N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement',N'TextBoxElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssis.ProjectElement', N'CD.DLS.Model.Mssql.Ssis.PackageElement',N'PackageElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssis.FolderElement', N'CD.DLS.Model.Mssql.Ssis.PackageElement',N'PackageElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssis.CatalogElement', N'CD.DLS.Model.Mssql.Ssis.PackageElement',N'PackageElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Db.SchemaElement', N'CD.DLS.Model.Mssql.Db.ViewElement',N'ViewElement'),
(N'CD.DLS.Model.Mssql.Db.SchemaElement', N'CD.DLS.Model.Mssql.Db.SchemaTableElement',N'SchemaTableElement'),
(N'CD.DLS.Model.Mssql.Db.SchemaElement', N'CD.DLS.Model.Mssql.Db.ColumnElement',N'ColumnElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssrs.ReportElement', N'CD.DLS.Model.Mssql.Ssrs.ReportElement',N'ReportElement'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportElement', N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement',N'TextBoxElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssis.PackageElement', N'CD.DLS.Model.Mssql.Ssis.PackageElement',N'PackageElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', N'CD.DLS.Model.Mssql.Ssas.CubeElement',N'CubeElement'),
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement',N'MdxScriptElement'),
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement',N'MeasureGroupElement'),
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement',N'PhysicalMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement',N'CubeCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.CubeElement', N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement',N'ReportCalculatedMeasureElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssas.DimensionElement', N'CD.DLS.Model.Mssql.Ssas.DimensionElement',N'DimensionElement'),
(N'CD.DLS.Model.Mssql.Ssas.DimensionElement', N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement',N'DimensionAttributeElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement', N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement',N'MdxScriptElement'),
(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement', N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement',N'CubeCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement', N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement',N'ReportCalculatedMeasureElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Db.ViewElement', N'CD.DLS.Model.Mssql.Db.ViewElement',N'ViewElement'),
(N'CD.DLS.Model.Mssql.Db.ViewElement', N'CD.DLS.Model.Mssql.Db.ColumnElement',N'ColumnElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Db.SchemaTableElement', N'CD.DLS.Model.Mssql.Db.SchemaTableElement',N'SchemaTableElement'),
(N'CD.DLS.Model.Mssql.Db.SchemaTableElement', N'CD.DLS.Model.Mssql.Db.ColumnElement',N'ColumnElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement', N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement',N'PhysicalMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement', N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement',N'CubeCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement', N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement',N'ReportCalculatedMeasureElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Db.ProcedureElement', N'CD.DLS.Model.Mssql.Db.ProcedureElement',N'ProcedureElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement', N'SsasTabularTableColumnElement'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'SsasTabularTableElement'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularDatabaseElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularMeasureElement', N'SsasTabularMeasureElement')


INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement', N'SsasTabularTableColumnElement'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'SsasTabularTableElement'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableElement', N'SsasTabularMeasureElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Pbi.ReportElement', N'CD.DLS.Model.Mssql.Pbi.ReportSectionElement', N'ReportSectionElement'),
(N'CD.DLS.Model.Mssql.Pbi.ReportElement', N'CD.DLS.Model.Mssql.Pbi.ConnectionElement', N'ConnectionElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Pbi.ConnectionElement', N'CD.DLS.Model.Mssql.Pbi.PbiTableElement', N'TableElement')

INSERT INTO [BIDoc].[HighLevelTypeDescendants]
([ParentType], [DescendantType], [NodeType])
VALUES
(N'CD.DLS.Model.Mssql.Pbi.ReportSectionElement', N'CD.DLS.Model.Mssql.Pbi.VisualElement', N'VisualElement')

TRUNCATE TABLE [BIDoc].[SequenceEndpointTypes]

INSERT INTO [BIDoc].[SequenceEndpointTypes]([TypeName])
VALUES

	--(N'CD.DLS.Model.Mssql.Ssrs.ReportElement'),
	--(N'CD.DLS.Model.Mssql.Ssrs.TextBoxElement'),
	--(N'CD.DLS.Model.Mssql.Ssis.PackageElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.CubeElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.DimensionElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.MdxScriptElement'),
	--(N'CD.DLS.Model.Mssql.Db.DatabaseElement'),
	--(N'CD.DLS.Model.Mssql.Db.ViewElement'),
	--(N'CD.DLS.Model.Mssql.Db.SchemaTableElement'),
	--(N'CD.DLS.Model.Mssql.Db.ColumnElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.MeasureGroupElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.CalculatedMeasureElement'),
	--(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionElement'),

(N'CD.DLS.Model.Mssql.Db.ColumnElement'),
--(N'CD.DLS.Model.Mssql.Db.DeclareVariableElement'),
--(N'CD.DLS.Model.Mssql.Db.ForeignDbTableElement'),
--(N'CD.DLS.Model.Mssql.Db.ProcedureElement'),
--(N'CD.DLS.Model.Mssql.Db.ScalarUdfElement'),
--(N'CD.DLS.Model.Mssql.Db.SchemaTableElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlDmlSourceElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlDmlTargetReferenceElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOperandColumnElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOutputColumnElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlScriptElement'),
--(N'CD.DLS.Model.Mssql.Db.TableUdfElement'),
--(N'CD.DLS.Model.Mssql.Db.ViewElement'),
(N'CD.DLS.Model.Mssql.Ssas.CubeCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.ReportCalculatedMeasureElement'),
(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionElement'),
--(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewColumnElement'),
--(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewTableElement'),
(N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement'),
(N'CD.DLS.Model.Mssql.Ssas.DimensionElement'),
(N'CD.DLS.Model.Mssql.Ssas.HierarchyElement'),
--(N'CD.DLS.Model.Mssql.Ssas.HierarchyLevelElement'),
(N'CD.DLS.Model.Mssql.Ssas.MdxFragmentElement'),
--(N'CD.DLS.Model.Mssql.Ssas.PartitionColumnElement'),
(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement'),
--(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasurePartitionSourceElement'),
--(N'CD.DLS.Model.Mssql.Ssis.ConnectionManagerElement'),
--(N'CD.DLS.Model.Mssql.Ssis.DbConnectionManagerElement'),
(N'CD.DLS.Model.Mssql.Ssis.DfColumnElement'),
--(N'CD.DLS.Model.Mssql.Ssis.DfLookupColumnElement'),
--(N'CD.DLS.Model.Mssql.Ssis.DfUnpivotSourceReferenceElement'),
--(N'CD.DLS.Model.Mssql.Ssis.FileConnectionManagerElement'),
(N'CD.DLS.Model.Mssql.Ssis.PackageParameterElement'),
--(N'CD.DLS.Model.Mssql.Ssis.SystemVariableElement'),
--(N'CD.DLS.Model.Mssql.Ssis.VariableElement'),
--(N'CD.DLS.Model.Mssql.Ssrs.DataSetFieldElement'),
(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterElement'),

--(N'CD.DLS.Model.Mssql.Db.ColumnElement'),
--(N'CD.DLS.Model.Mssql.Db.SchemaTableElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlDmlSourceElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlDmlTargetReferenceElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOperandColumnElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlNAryOperationOutputColumnElement'),
--(N'CD.DLS.Model.Mssql.Db.SqlScriptElement'),
--(N'CD.DLS.Model.Mssql.Ssas.CubeDimensionElement'),
--(N'CD.DLS.Model.Mssql.Ssas.DatasourceViewColumnElement'),
--(N'CD.DLS.Model.Mssql.Ssas.DimensionAttributeElement'),
--(N'CD.DLS.Model.Mssql.Ssas.HierarchyLevelElement'),
(N'CD.DLS.Model.Mssql.Ssas.KeyColumnElement'),
--(N'CD.DLS.Model.Mssql.Ssas.MdxFragmentElement'),
(N'CD.DLS.Model.Mssql.Ssas.NameColumnElement'),
--(N'CD.DLS.Model.Mssql.Ssas.PartitionColumnElement'),
--(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasureElement'),
--(N'CD.DLS.Model.Mssql.Ssas.PhysicalMeasurePartitionSourceElement'),
--(N'CD.DLS.Model.Mssql.Ssis.DfColumnElement'),
--(N'CD.DLS.Model.Mssql.Ssis.DfLookupColumnElement'),
(N'CD.DLS.Model.Mssql.Ssis.DfSourceElement'),
--(N'CD.DLS.Model.Mssql.Ssis.DfUnpivotSourceReferenceElement'),
(N'CD.DLS.Model.Mssql.Ssrs.DataSetFieldElement'),
--(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterDefaultValuesDataSetElement'),
--(N'CD.DLS.Model.Mssql.Ssrs.ReportParameterValidValuesDataSetElement'),
(N'CD.DLS.Model.Mssql.Ssrs.SsrsExpressionFragmentElement'),

(N'CD.DLS.Model.Mssql.Tabular.SsasTabularTableColumnElement'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularMeasureElement'),
(N'CD.DLS.Model.Mssql.Tabular.SsasTabularHierarchyLevelElement')

TRUNCATE TABLE Annotate.AnnotationElementTypeDescriptions


INSERT INTO Annotate.AnnotationElementTypeDescriptions(ElementType, TypeDescription)
VALUES
(N'CD.DLS.Annotate.Excel.PivotTableTemplateElement', N'Pivot Table Template')

GO

GO
